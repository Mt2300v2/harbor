<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Harbor - Library</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');

        :root {
            --bg-color: #121a25;
            --glass-bg: rgba(30, 40, 55, 0.6);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-primary: #e0e0e0;
            --text-secondary: #a0a0a0;
            --accent-blue: #00aaff;
            --accent-green: #4caf50;
            --accent-red: #f44336;
            --highlight-bg: rgba(255, 255, 255, 0.08);
            --emulation-color: #ff9800;
            --font-family: 'Inter', sans-serif;
            --bold-weight: 900;
            --transition-speed: 0.4s; /* Global speed */
            --animation-duration: 0.35s; /* Game switch duration */
            --border-radius: 12px;
            --icon-size-meta: 24px;
            --icon-size-button: 20px;
            --banner-blur-amount: 6px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: var(--font-family); background-color: var(--bg-color); color: var(--text-primary); margin: 0; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }
        .app-container { display: flex; flex-direction: column; height: 100vh; }
        .app-header { display: flex; align-items: center; padding: 10px 20px; background: linear-gradient(to bottom, rgba(25, 35, 50, 0.9), rgba(18, 26, 37, 0.8)); backdrop-filter: blur(10px); border-bottom: 1px solid var(--glass-border); position: relative; z-index: 100; flex-shrink: 0; }
        .logo { font-size: 1.5em; font-weight: var(--bold-weight); color: var(--accent-blue); margin-right: 30px; text-shadow: 0 0 5px rgba(0, 170, 255, 0.5); }
        .nav-tabs { display: flex; gap: 10px; }
        .nav-tab { padding: 10px 20px; font-weight: 700; cursor: pointer; border-radius: var(--border-radius); transition: background-color var(--transition-speed), color var(--transition-speed); border: 1px solid transparent; background-color: transparent; color: var(--text-secondary); }
        .nav-tab.active, .nav-tab:hover { background-color: var(--glass-bg); color: var(--text-primary); border: 1px solid var(--glass-border); box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3); }
        .user-controls { margin-left: auto; display: flex; align-items: center; gap: 15px; }
        .user-profile-icon { width: 36px; height: 36px; background-color: var(--text-secondary); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23121a25"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>'); background-size: cover; border: 2px solid var(--glass-border); }
        .main-content { flex-grow: 1; display: flex; overflow: hidden; position: relative; }
        .content-area { flex-grow: 1; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: auto; opacity: 0; visibility: hidden; transition: opacity var(--transition-speed) ease-in-out, visibility 0s var(--transition-speed); background-color: var(--bg-color); scrollbar-width: thin; scrollbar-color: var(--glass-border) transparent; }
         .content-area::-webkit-scrollbar { width: 8px; } .content-area::-webkit-scrollbar-track { background: transparent; } .content-area::-webkit-scrollbar-thumb { background-color: var(--glass-border); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; }
        .content-area.active { opacity: 1; visibility: visible; transition: opacity var(--transition-speed) ease-in-out, visibility 0s 0s; z-index: 1; }
        .library-container { display: flex; height: 100%; }
        .library-sidebar { width: 250px; flex-shrink: 0; background-color: var(--glass-bg); border-right: 1px solid var(--glass-border); backdrop-filter: blur(15px); padding: 15px 0; overflow-y: auto; height: 100%; scrollbar-width: thin; scrollbar-color: var(--glass-border) transparent; }
         .library-sidebar::-webkit-scrollbar { width: 6px; } .library-sidebar::-webkit-scrollbar-thumb { background-color: var(--glass-border); border-radius: 10px; }
        .library-sidebar-header { padding: 0 15px 15px 15px; border-bottom: 1px solid var(--glass-border); margin-bottom: 10px; }
         .library-sidebar-header input[type="text"] { width: 100%; padding: 8px 12px; border-radius: 6px; border: 1px solid var(--glass-border); background: rgba(0,0,0,0.3); color: var(--text-primary); margin-bottom: 10px; font-size: 0.9em; outline: none; }
          .library-sidebar-header input[type="text"]:focus { border-color: var(--accent-blue); box-shadow: 0 0 5px rgba(0, 170, 255, 0.3); }
        .library-sidebar-header button { background: rgba(255, 255, 255, 0.1); border: 1px solid var(--glass-border); color: var(--text-secondary); padding: 8px 12px; width: 100%; border-radius: 6px; cursor: pointer; font-size: 0.9em; transition: background-color var(--transition-speed); }
        .library-sidebar-header button:hover { background: rgba(255, 255, 255, 0.2); color: var(--text-primary); }
        .library-game-list { list-style: none; } .library-placeholder { padding: 20px 15px; color: var(--text-secondary); font-style: italic; text-align: center; }
        .library-game-item { display: flex; align-items: center; padding: 10px 15px; cursor: pointer; transition: background-color var(--transition-speed); border-left: 3px solid transparent; }
        .library-game-item img { width: 32px; height: 32px; object-fit: cover; margin-right: 10px; border-radius: 4px; flex-shrink: 0; }
        .library-game-item span { font-size: 0.95em; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; color: var(--text-secondary); transition: color var(--transition-speed); }
        .library-game-item:hover { background-color: var(--highlight-bg); } .library-game-item:hover span { color: var(--text-primary); }
        .library-game-item.active { background-color: rgba(0, 170, 255, 0.15); border-left-color: var(--accent-blue); } .library-game-item.active span { color: var(--text-primary); font-weight: 700; }

        /* Game Detail View for positioning children */
        .game-details-view {
             flex-grow: 1; overflow-y: auto; overflow-x: hidden;
             position: relative; /* Important for absolute children */
             background-color: var(--bg-color); scrollbar-width: thin; scrollbar-color: var(--glass-border) transparent;
        }
         .game-details-view.active { opacity: 1; }

         /* Game Detail Content Container Styling */
        #game-details-content {
             position: absolute; /* Stack on top for transitions */
             top: 0; left: 0; width: 100%; height: 100%;
             overflow-y: auto; /* Allow scrolling WITHIN the details content */
              scrollbar-width: thin; scrollbar-color: var(--glass-border) transparent;
              opacity: 0; /* Start hidden */
             transform: translateX(20px); /* Start slightly to the right */
             transition: opacity var(--animation-duration) ease-in-out, transform var(--animation-duration) ease-in-out;
             will-change: opacity, transform; /* Hint browser about transitions */
         }
          /* Style for incoming content */
         #game-details-content.fade-in {
             opacity: 1;
             transform: translateX(0);
             z-index: 10; /* Ensure it's on top during transition */
         }
         /* Style for outgoing content */
         #game-details-content.fade-out {
             opacity: 0;
             transform: translateX(-20px); /* Move slightly left */
             z-index: 5; /* Ensure it's below incoming */
         }

        /* Banner blur & layering */
        .game-banner { height: 400px; width: 100%; position: relative; overflow: hidden; background-size: cover; /* Move background-image setting here */ background-position: center center; }
        .game-banner::before { /* Blur layer */ content: ''; position: absolute; top: calc(-1 * var(--banner-blur-amount)); left: calc(-1 * var(--banner-blur-amount)); right: calc(-1 * var(--banner-blur-amount)); bottom: calc(-1 * var(--banner-blur-amount)); background-image: inherit; background-size: cover; background-position: center center; filter: blur(var(--banner-blur-amount)); z-index: 1; }
        .game-banner::after { /* Gradient overlay */ content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(to top, rgba(18, 26, 37, 1) 0%, rgba(18, 26, 37, 0.7) 30%, rgba(18, 26, 37, 0) 60%); z-index: 2; }
        .game-header, .game-actions { z-index: 5; }

        .game-header { position: absolute; bottom: 20px; left: 30px; max-width: calc(100% - 350px); color: #fff; }
        .game-title { font-size: 3.5em; font-weight: var(--bold-weight); margin: 0; text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.9); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .game-price { display: none; }
        .game-actions { position: absolute; top: 20px; right: 30px; display: flex; flex-direction: column; align-items: flex-end; gap: 10px; }
         .game-actions-buttons { display: flex; gap: 15px; }
        .action-button { padding: 12px 25px; font-size: 1.1em; font-weight: 700; border: none; border-radius: var(--border-radius); cursor: pointer; display: flex; align-items: center; gap: 8px; transition: all var(--transition-speed); box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4); }
        .action-button .button-icon { width: var(--icon-size-button); height: var(--icon-size-button); display: inline-flex; align-items: center; justify-content: center; }
         .action-button .button-icon svg { width: 100%; height: 100%; object-fit: contain; fill: white; }
        .play-button { background: linear-gradient(135deg, var(--accent-green), #388e3c); color: white; order: 1; min-width: 140px; justify-content: center; }
         .play-button[data-state="not_downloaded"] { background: linear-gradient(135deg, var(--accent-blue), #0077cc); }
         .play-button[data-state="downloading"] { background: linear-gradient(135deg, #556677, #4a5c75); cursor: not-allowed; }
        .play-button:hover:not(:disabled) { filter: brightness(1.1); transform: translateY(-2px); box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4); }
        .play-button[data-state="not_downloaded"]:hover { box-shadow: 0 6px 20px rgba(0, 170, 255, 0.4); }
        .settings-button { background: var(--glass-bg); color: var(--text-primary); border: 1px solid var(--glass-border); padding: 12px; position: relative; order: 2; }
        .settings-button .button-icon svg { fill: var(--text-primary); }
        .settings-button:hover { background: rgba(255, 255, 255, 0.15); transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2); }
        .settings-dropdown { display: none; position: absolute; top: calc(100% + 10px); right: 0; background-color: rgba(35, 48, 66, 0.95); backdrop-filter: blur(15px); border: 1px solid var(--glass-border); border-radius: 8px; padding: 15px; width: 250px; z-index: 110; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5); color: var(--text-primary); }
         .settings-dropdown.visible { display: block; animation: fadeInDown 0.3s ease-out; }
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .setting-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
         .setting-item:last-child { border-bottom: none; } .setting-item label { font-size: 0.95em; margin-right: 10px; }
        .switch { position: relative; display: inline-block; width: 40px; height: 20px; flex-shrink: 0; } .switch input { display:none; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #4a5c75; transition: .4s; border-radius: 20px; } .slider:before { position: absolute; content: ""; height: 14px; width: 14px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; } input:checked + .slider { background-color: var(--accent-green); } input:checked + .slider:before { transform: translateX(20px); }
        .game-content-area { display: flex; padding: 30px; gap: 30px; padding-top: 30px; }
        .game-left-column { flex: 1; min-width: 250px; max-width: 350px; flex-shrink: 0; }
         .game-cover { width: 100%; aspect-ratio: 3 / 4; object-fit: cover; border-radius: var(--border-radius); box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4); margin-bottom: 25px; }
         .game-info-panel, .game-specs-panel, .game-achievements-panel { background-color: var(--glass-bg); padding: 20px; border-radius: var(--border-radius); border: 1px solid var(--glass-border); margin-bottom: 25px; backdrop-filter: blur(10px); }
          .game-info-panel h3, .game-specs-panel h3, .game-achievements-panel h3 { margin-top: 0; margin-bottom: 15px; font-size: 1.2em; font-weight: 700; color: var(--accent-blue); border-bottom: 1px solid var(--glass-border); padding-bottom: 10px; }
         .game-info-panel p { font-size: 0.95em; line-height: 1.6; color: var(--text-secondary); }
        .game-right-column { flex: 3; min-width: 0; }
        .media-viewer { width: 100%; aspect-ratio: 16 / 9; background-color: #000; border-radius: var(--border-radius); overflow: hidden; margin-bottom: 20px; position: relative; border: 1px solid var(--glass-border); box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
         .media-viewer video { background-color: #000; object-fit: contain; } .media-viewer iframe { width: 100%; height: 100%; border: none; }
         .media-viewer img, .media-viewer video, .media-viewer iframe { width: 100%; height: 100%; display: block; position: absolute; top: 0; left: 0; opacity: 0; visibility: hidden; transition: opacity 0.5s ease-in-out; }
         .media-viewer img.active, .media-viewer video.active, .media-viewer iframe.active { opacity: 1; visibility: visible; }
        .media-thumbnails { display: flex; gap: 10px; margin-bottom: 30px; overflow-x: auto; padding: 5px 10px 10px 15px; scrollbar-width: thin; scrollbar-color: var(--glass-border) transparent; }
          .media-thumbnails::-webkit-scrollbar { height: 6px; } .media-thumbnails::-webkit-scrollbar-thumb { background-color: var(--glass-border); border-radius: 10px; }
         .media-thumbnail { width: 100px; height: 56.25px; object-fit: cover; border-radius: 6px; cursor: pointer; border: 2px solid transparent; transition: border-color var(--transition-speed), transform var(--transition-speed), opacity var(--transition-speed); opacity: 0.7; flex-shrink: 0; background-color: #222; position: relative; }
         /* --- Play Button Indicator for Video/Iframe Thumbnails --- */
         .media-thumbnail[data-type="video"]::after,
         .media-thumbnail[data-type="iframe"]::after {
            content: '▶';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5em; /* Adjusted size */
            color: rgba(255, 255, 255, 0.8);
            text-shadow: 0 0 5px black;
            pointer-events: none; /* So it doesn't interfere with clicks */
            opacity: 0.8;
            transition: opacity 0.2s;
        }
         .media-thumbnail[data-type="video"]:hover::after,
         .media-thumbnail[data-type="iframe"]:hover::after {
            opacity: 1; /* Slightly more visible on hover */
         }
         .media-thumbnail:hover { opacity: 1; transform: scale(1.05); }
         .media-thumbnail.active { border-color: var(--accent-blue); opacity: 1; transform: scale(1.05); }
        /* --- End Play Button --- */
        .game-meta-info { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 20px; margin-bottom: 30px; }
         .meta-item { background-color: rgba(255, 255, 255, 0.05); padding: 15px; border-radius: 8px; border: 1px solid var(--glass-border); display: flex; align-items: center; gap: 12px; position: relative; cursor: default; transition: background-color var(--transition-speed); overflow: hidden; }
         .meta-item.hoverable { cursor: help; } .meta-item.hoverable::after { content: ''; position: absolute; bottom: 5px; left: 15px; width: calc(100% - 30px); height: 1px; background: rgba(0, 170, 255, 0.5); transform: scaleX(0); transition: transform 0.2s ease-out; transform-origin: left; } .meta-item.hoverable:hover { background-color: rgba(255, 255, 255, 0.08); } .meta-item.hoverable:hover::after { transform: scaleX(1); }
        .meta-item-icon { width: var(--icon-size-meta); height: var(--icon-size-meta); flex-shrink: 0; display: flex; align-items: center; justify-content: center; }
         .meta-item-icon img, .meta-item-icon svg { max-width: 100%; max-height: 100%; width: auto; height: auto; object-fit: contain; display: block; }
         .meta-item-icon img { filter: invert(0.8); } .meta-item-icon svg { fill: var(--text-secondary); }
         .meta-item.verified .meta-item-icon svg { fill: var(--accent-green); }
         .meta-item-icon.steamdeck-icon svg { fill: var(--text-primary); }
         .meta-item-text { font-size: 0.9em; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }
         .meta-item-text strong { display: block; font-weight: 700; color: var(--text-primary); margin-bottom: 2px; } .meta-item-text span { color: var(--text-secondary); display: inline-flex; align-items: center; gap: 5px; width: 100%; } .meta-item-text span svg { width: 16px; height: 16px; flex-shrink: 0; vertical-align: middle; }
        .tooltip { position: fixed; background-color: rgba(35, 48, 66, 0.98); backdrop-filter: blur(15px); border: 1px solid var(--glass-border); border-radius: 8px; padding: 15px; z-index: 1000; opacity: 0; visibility: hidden; transition: opacity 0.2s ease-out, visibility 0s 0.2s, transform 0.2s ease-out; transform: translateY(10px); min-width: 250px; max-width: 400px; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5); color: var(--text-primary); pointer-events: none; font-size: 0.95em; } .tooltip.visible { opacity: 1; visibility: visible; transform: translateY(0); transition: opacity 0.2s ease-out, visibility 0s 0s, transform 0.2s ease-out; }
        .pie-chart-container { display: flex; align-items: center; gap: 15px; width: 100%; }
         .pie-chart { width: 80px; height: 80px; position: relative; flex-shrink: 0; }
         .pie-chart-svg { transform: rotate(-90deg); viewbox: 0 0 90 90; }
         .pie-chart-bg { fill: none; stroke: rgba(255, 255, 255, 0.1); r:35; cx:45; cy:45; stroke-width: 10;}
         .pie-chart-game, .pie-chart-other { fill: none; r:35; cx:45; cy:45; stroke-width: 10; stroke-linecap: round; transition: stroke-dashoffset 0.5s ease-out; }
         .pie-chart-game { stroke: var(--accent-blue); } .pie-chart-other { stroke: var(--text-secondary); }
         .pie-legend { font-size: 0.85em; flex-grow: 1; min-width: 0; } .legend-item { display: flex; align-items: center; margin-bottom: 4px; } .legend-color-box { width: 10px; height: 10px; margin-right: 6px; border-radius: 3px; flex-shrink: 0; } .legend-text { line-height: 1.3; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; } .legend-text strong { font-weight: 700; color: var(--text-primary); } .pie-legend .disk-total { font-size: 0.9em; color: var(--text-secondary); margin-top: 5px; text-align: right;}
        .review-feed { max-height: 200px; overflow: hidden; position: relative; -webkit-mask-image: linear-gradient(transparent 0%, black 10%, black 90%, transparent 100%); mask-image: linear-gradient(transparent 0%, black 10%, black 90%, transparent 100%); }
        .review-feed-content { padding-right: 10px; } .review-item { padding: 10px 0; border-bottom: 1px solid var(--glass-border); font-size: 0.9em; line-height: 1.4; color: var(--text-secondary); } .review-item:last-child { border-bottom: none; } .review-item strong { color: var(--text-primary); font-weight: 700;}
        .achieve-tooltip-content { font-size: 0.9em; text-align: center; line-height: 1.4; }
        .hltb-tooltip-content { font-size: 0.9em; } .hltb-bar-container { height: 15px; background: rgba(255,255,255,0.1); border-radius: 8px; margin: 10px 0 25px 0; position: relative; overflow: hidden; } .hltb-progress-bar { height: 100%; background: linear-gradient(to right, var(--accent-blue), #0077cc); border-radius: 8px; position: absolute; left: 0; top: 0; transition: width 0.5s ease-out; } .hltb-marker { position: absolute; top: -2px; bottom: -2px; width: 2px; background: rgba(255, 255, 255, 0.5); pointer-events: none; } .hltb-label { position: absolute; top: 100%; padding-top: 5px; transform: translateX(-50%); font-size: 0.8em; color: var(--text-secondary); white-space: nowrap; }
        /* Achievements List Styling */
        .game-achievements-list { display: flex; gap: 15px; flex-wrap: wrap; }
        .achievement-item { display: flex; align-items: center; gap: 10px; background: rgba(255, 255, 255, 0.05); padding: 8px; border-radius: 6px; position: relative; cursor: default; flex-basis: calc(33.333% - 10px); min-width: 150px; transition: background-color var(--transition-speed); }
        .achievement-item.hoverable { cursor: help; } .achievement-item.hoverable:hover { background-color: rgba(255, 255, 255, 0.1); }
        .achievement-icon { width: 48px; height: 48px; object-fit: cover; border-radius: 4px; flex-shrink: 0; }
        .achievement-unlock-icon { position: absolute; bottom: -5px; right: -5px; width: 20px; height: 20px; transform: rotate(45deg); display: flex; align-items: center; justify-content: center; }
        .achievement-unlock-icon img, .achievement-unlock-icon svg { width: 100%; height: 100%; object-fit: contain; filter: invert(0.8) drop-shadow(0 0 3px rgba(0,0,0,0.5)); }
        .achievement-name { font-size: 0.9em; color: var(--text-secondary); line-height: 1.3; word-break: break-word; position: relative; }
        .achievement-item.hoverable .achievement-name::after { content: ''; position: absolute; bottom: -2px; left: 0; right: 0; height: 1px; background: rgba(0, 170, 255, 0.5); transform: scaleX(0); transition: transform 0.2s ease-out; transform-origin: left; }
        .achievement-item.hoverable:hover .achievement-name::after { transform: scaleX(1); }
        /* See More Button */
        .see-more-achievements-button {
            background: rgba(255, 255, 255, 0.1); border: 1px solid var(--glass-border); color: var(--text-secondary);
            padding: 8px 15px; width: calc(100% - 0px); /* Adjust width if needed */ margin-top: 15px; border-radius: 6px;
            cursor: pointer; font-size: 0.9em; transition: background-color var(--transition-speed); text-align: center;
            font-weight: 700; display: block; /* Ensure it takes full width */
        }
        .see-more-achievements-button:hover { background: rgba(255, 255, 255, 0.2); color: var(--text-primary); }
        /* Achievement Modal */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.7); backdrop-filter: blur(8px);
            display: none; align-items: center; justify-content: center;
            z-index: 1001; opacity: 0; transition: opacity var(--transition-speed) ease-out;
        }
        .modal-overlay.visible { display: flex; opacity: 1; }
        .modal-content {
            background: var(--glass-bg); border: 1px solid var(--glass-border);
            padding: 25px; border-radius: var(--border-radius);
            width: 90%; max-width: 800px; max-height: 80vh; /* Limit height */
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            position: relative; display: flex; flex-direction: column;
        }
        .modal-content h3 { margin-top: 0; margin-bottom: 20px; color: var(--accent-blue); font-size: 1.5em; text-align: center; border-bottom: 1px solid var(--glass-border); padding-bottom: 15px; }
        .modal-close-button {
            position: absolute; top: 15px; right: 15px;
            background: transparent; border: none; font-size: 2em;
            color: var(--text-secondary); cursor: pointer; line-height: 1; padding: 0 5px;
            transition: color var(--transition-speed);
        }
        .modal-close-button:hover { color: var(--text-primary); }
        #achievements-modal-list {
            overflow-y: auto; /* Enable scrolling */
            flex-grow: 1; /* Allow list to take available space */
             scrollbar-width: thin; scrollbar-color: var(--glass-border) transparent;
             padding-right: 10px; /* Space for scrollbar */
         }
        #achievements-modal-list::-webkit-scrollbar { width: 8px; }
        #achievements-modal-list::-webkit-scrollbar-track { background: transparent; }
        #achievements-modal-list::-webkit-scrollbar-thumb { background-color: var(--glass-border); border-radius: 10px; }
        .modal-achievement-item {
            display: flex; align-items: center; gap: 15px;
            padding: 12px 0; border-bottom: 1px solid var(--glass-border);
        }
        .modal-achievement-item:last-child { border-bottom: none; }
        .modal-achievement-icon { width: 64px; height: 64px; object-fit: contain; border-radius: 4px; flex-shrink: 0; }
        .modal-achievement-details { flex-grow: 1; }
        .modal-achievement-name { font-size: 1em; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .modal-achievement-desc { font-size: 0.9em; color: var(--text-secondary); line-height: 1.5; }

        .tech-tags { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 15px; } .tech-tag { padding: 5px 10px; border-radius: 6px; font-size: 0.85em; font-weight: 700; text-transform: uppercase; border: 1px solid transparent; display: inline-flex; align-items: center; gap: 5px; white-space: nowrap; }
         .tech-tag svg { width: 14px; height: 14px; flex-shrink: 0; fill: currentColor; }
         .tech-tag.supported { background-color: rgba(0, 170, 255, 0.2); color: var(--accent-blue); border-color: rgba(0, 170, 255, 0.5); }
         .tech-tag.unsupported { background-color: rgba(170, 170, 170, 0.1); color: var(--text-secondary); text-decoration: line-through; border-color: rgba(170, 170, 170, 0.3); }
         .tech-tag.verified { background-color: rgba(76, 175, 80, 0.2); color: var(--accent-green); border-color: rgba(76, 175, 80, 0.5); } .tech-tag.verified svg { fill: var(--accent-green); }
         .tech-tag.emulation { background-color: rgba(255, 152, 0, 0.2); color: var(--emulation-color); border-color: rgba(255, 152, 0, 0.5); }
         .execution-label { font-size: 0.9em; color: var(--text-secondary); margin-top: 15px; margin-bottom: 10px; display: block; border-top: 1px solid var(--glass-border); padding-top: 15px;}
         .execution-label strong { color: var(--text-primary); margin-right: 5px; } .execution-label span.native { color: var(--accent-green); font-weight: 700; } .execution-label span.emulation { color: var(--emulation-color); font-weight: 700; }
        .min-specs-list { font-size: 0.9em; color: var(--text-secondary); line-height: 1.6; margin-top: 5px; list-style-type: none; padding-left: 0; } .min-specs-list li { margin-bottom: 5px; } .min-specs-list strong { color: var(--text-primary); font-weight: 700; min-width: 80px; display: inline-block; }
        .download-progress-container { width: 100%; height: 20px; display: none; align-items: center; gap: 10px; background: rgba(0,0,0,0.3); padding: 0 10px; border-radius: 6px; margin-top: 5px; box-sizing: border-box; } .download-progress-container.visible { display: flex; } .progress-bar-bg { flex-grow: 1; height: 8px; background-color: rgba(255, 255, 255, 0.1); border-radius: 4px; overflow: hidden; position: relative; } .progress-bar-fg { width: 0%; height: 100%; background: linear-gradient(to right, var(--accent-blue), #0077cc); border-radius: 4px; transition: width 0.1s linear; } .download-speed { font-size: 0.85em; color: var(--text-secondary); width: 80px; text-align: right; flex-shrink: 0; }
        .store-page { padding: 30px; overflow-y: auto; height: 100%; background: linear-gradient(180deg, var(--bg-color) 0%, #0a1018 100%); } .store-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid var(--glass-border); flex-wrap: wrap; gap: 15px; } .store-header h2 { font-size: 2em; font-weight: var(--bold-weight); color: var(--text-primary); text-shadow: 0 0 8px rgba(0, 170, 255, 0.3); } .cart-button { padding: 10px 20px; font-weight: 700; border: 1px solid var(--glass-border); border-radius: var(--border-radius); cursor: pointer; background-color: var(--glass-bg); color: var(--text-primary); transition: background-color var(--transition-speed), transform var(--transition-speed); position: relative; display: inline-flex; align-items: center; gap: 8px; } .cart-button::before { content: ''; display: inline-block; width: 20px; height: 20px; background-color: currentColor; mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zm10 0c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2zm-1.45-5c.75 0 1.41-.41 1.75-1.03l3.58-6.49A.996.996 0 0 0 20.01 4H5.21l-.94-2H1v2h2l3.6 7.59-1.35 2.44C4.52 15.37 5.48 17 7 17h11v-2H7l1.1-2h7.45z"/></svg>'); mask-size: contain; mask-repeat: no-repeat; mask-position: center; } .cart-button:hover { background-color: rgba(255, 255, 255, 0.15); transform: translateY(-2px); } .cart-count { position: absolute; top: -8px; right: -8px; background-color: var(--accent-red); color: white; border-radius: 50%; width: 20px; height: 20px; font-size: 0.8em; display: flex; align-items: center; justify-content: center; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.4); }
        .store-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 25px; } .store-item { background: var(--glass-bg); border-radius: var(--border-radius); overflow: hidden; border: 1px solid var(--glass-border); transition: transform var(--transition-speed), box-shadow var(--transition-speed); display: flex; flex-direction: column; position: relative; box-shadow: 0 5px 15px rgba(0,0,0,0.2); } .store-item:hover { transform: translateY(-5px); box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4); } .store-item-image { width: 100%; aspect-ratio: 4 / 3; object-fit: cover; background-color: #333; } .store-item-info { padding: 15px; flex-grow: 1; display: flex; flex-direction: column; gap: 5px; } .store-item-title { font-size: 1.1em; font-weight: 700; margin-bottom: 0; } .store-item-price { color: var(--accent-green); font-weight: 700; margin-bottom: 10px; } .add-to-cart-button { margin-top: auto; width: 100%; padding: 10px; font-weight: 700; border: none; border-radius: 6px; cursor: pointer; background: linear-gradient(135deg, var(--accent-blue), #0077cc); color: white; transition: background var(--transition-speed), filter var(--transition-speed); display: flex; align-items: center; justify-content: center; gap: 8px; } .add-to-cart-button::before { content: ''; display: inline-block; width: 16px; height: 16px; background-color: currentColor; mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>'); mask-size: contain; } .add-to-cart-button:hover:not(:disabled) { background: linear-gradient(135deg, #33bbff, var(--accent-blue)); filter: brightness(1.1); } .add-to-cart-button.in-cart { background: linear-gradient(135deg, var(--accent-green), #388e3c); cursor: default; } .add-to-cart-button.in-cart::before { mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" d="M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>'); } .add-to-cart-button.owned { background: linear-gradient(135deg, #556677, #4a5c75); cursor: default; } .add-to-cart-button.owned::before { mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" d="M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>'); }
        .checkout-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.8); backdrop-filter: blur(10px); display: none; align-items: center; justify-content: center; z-index: 1001; opacity: 0; transition: opacity var(--transition-speed); } .checkout-modal.visible { display: flex; opacity: 1; } .checkout-content { background: var(--glass-bg); padding: 30px; border-radius: var(--border-radius); border: 1px solid var(--glass-border); text-align: center; width: 90%; max-width: 500px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); } .checkout-content h3 { margin-top: 0; margin-bottom: 15px; color: var(--accent-blue);} .checkout-content p { margin-bottom: 25px; color: var(--text-secondary);} #checkout-item-list { margin-bottom: 20px; text-align: left; max-height: 200px; overflow-y: auto; border: 1px solid var(--glass-border); border-radius: 6px; padding: 10px; scrollbar-width: thin; scrollbar-color: var(--glass-border) transparent; } #checkout-item-list::-webkit-scrollbar { width: 6px; } #checkout-item-list::-webkit-scrollbar-thumb { background-color: var(--glass-border); border-radius: 3px; } .checkout-actions button { padding: 10px 20px; font-weight: 700; border: 1px solid var(--glass-border); border-radius: var(--border-radius); cursor: pointer; background-color: var(--glass-bg); color: var(--text-primary); transition: background-color var(--transition-speed), filter var(--transition-speed); margin: 0 10px; } .checkout-actions button.confirm { background: linear-gradient(135deg, var(--accent-green), #388e3c); color: white; border-color: transparent; } .checkout-actions button.confirm:hover { filter: brightness(1.1); } .checkout-actions button.cancel { background: linear-gradient(135deg, #556677, #4a5c75); color: var(--text-primary); border-color: transparent; } .checkout-actions button.cancel:hover { filter: brightness(1.1); }
        .community-page { padding: 30px; overflow-y: auto; height: 100%; background: linear-gradient(180deg, var(--bg-color) 0%, #0a1018 100%); } .community-feed { max-width: 1200px; margin: 0 auto; padding-bottom: 30px; display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 25px; } .community-post { background-color: var(--glass-bg); padding: 20px; border-radius: var(--border-radius); border: 1px solid var(--glass-border); backdrop-filter: blur(10px); } .community-post h3 { margin-top: 0; margin-bottom: 15px; font-size: 1.2em; font-weight: 700; color: var(--accent-blue); border-bottom: 1px solid var(--glass-border); padding-bottom: 10px; } .community-post img { max-width: 100%; border-radius: 8px; margin-bottom: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); } .community-post p { font-size: 1em; line-height: 1.7; color: var(--text-secondary); margin-bottom: 1em; } .community-post p:last-child { margin-bottom: 0; } .community-post p strong { color: var(--text-primary); font-weight: 700; }
        .no-selection-placeholder { display: flex; align-items: center; justify-content: center; height: 100%; color: var(--text-secondary); font-size: 1.5em; text-align: center; padding: 20px; }

    </style>
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <div class="logo">Harbor</div>
            <nav class="nav-tabs">
                <button class="nav-tab active" data-tab="library">Library</button>
                <button class="nav-tab" data-tab="store">Store</button>
                <button class="nav-tab" data-tab="community">Community</button>
            </nav>
            <div class="user-controls">
                <div class="user-profile-icon"></div>
            </div>
        </header>
        <main class="main-content">
            <div class="content-area library-container active" id="library-tab">
                <aside class="library-sidebar">
                    <div class="library-sidebar-header">
                        <input type="text" placeholder="Search..." id="library-search">
                        <button id="reset-library-button">Reset Library</button>
                    </div>
                    <ul class="library-game-list" id="library-game-list">
                        <li class="library-placeholder">Loading library...</li>
                    </ul>
                </aside>
                <div class="game-details-view" id="game-details-view">
                    <div class="no-selection-placeholder" id="library-empty-placeholder">Select game or visit Store.</div>
                </div>
            </div>
            <div class="content-area store-page" id="store-tab">
                 <div class="store-header"> <h2>Store</h2> <button class="cart-button" id="cart-button"> <span>Cart</span> <span class="cart-count" id="cart-count">0</span> </button> </div> <div class="store-grid" id="store-grid"></div>
            </div>
            <div class="checkout-modal" id="checkout-modal"> <div class="checkout-content"> <h3>Checkout</h3> <p id="checkout-summary">Review items.</p> <div id="checkout-item-list"></div> <p style="margin-top:15px;font-size:.9em;color:var(--text-secondary)">(Simulation only)</p> <div class="checkout-actions" style="margin-top:25px;"> <button id="cancel-checkout-button" class="cancel">Cancel</button> <button id="confirm-checkout-button" class="confirm">Confirm</button> </div> </div> </div>
            <div class="content-area community-page" id="community-tab"> <div class="community-feed" id="community-feed"></div> </div>
        </main>
    </div>
    <div class="tooltip" id="info-tooltip"></div>

    <!-- Achievement Modal Structure -->
    <div id="achievements-modal" class="modal-overlay">
        <div class="modal-content">
            <h3>All Achievements</h3>
            <button id="close-achievements-modal" class="modal-close-button" aria-label="Close modal">&times;</button>
            <div id="achievements-modal-list">
                <!-- Achievements will be populated here by JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // --- Data ---
        const allGameData = {
             "celeste": { id: "celeste", name: "Celeste", executionType: "native", icon: "https://cdn.cloudflare.steamstatic.com/steamcommunity/public/images/apps/504230/04cb7aa0b497a3962e6b1655b7fd81a2cc95d18b.jpg", cover: "https://upload.wikimedia.org/wikipedia/commons/0/0f/Celeste_box_art_full.png", banner: "https://preview.redd.it/5mz7c4flv8f51.jpg?auto=webp&s=2b92a20f4a4fefc01073f093a1ec6e3fa874ba0d", trailer: "https://video.cloudflare.steamstatic.com/store_trailers/256706951/movie_max.webm?t=1516898311", screenshots: [ "https://shared.cloudflare.steamstatic.com/store_item_assets/steam/apps/504230/ss_1ad297c2044cdcf450ee83e56350cafb590da755.jpg", "https://shared.cloudflare.steamstatic.com/store_item_assets/steam/apps/504230/ss_03bfe6bd5ddac7f747c8d2aa1a4f82cfd53c6dcb.jpg", "https://shared.cloudflare.steamstatic.com/store_item_assets/steam/apps/504230/ss_4b0f0222341b64a37114033aca9994551f27c161.jpg" ], description: "Help Madeline survive her inner demons...", price: "$19.99", diskSizeGB: 1.2, totalDiskGB: 1024, reviews: { percent: 97, count: 115420, feed: [ "<strong>Overwhelmingly Positive:</strong> Masterpiece...", "<strong>Recommended:</strong> Controls amazing.", "<strong>Positive:</strong> Story hits hard.", "<strong>Must Play:</strong> Soundtrack incredible.", "<strong>Heartwarming:</strong> More than a game." ] }, achievements: [ { name: "Forsaken City", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/504230/6d16bf0629b862295a62b2d92ab22a94dc593903.jpg", desc: "Complete Chapter 1." }, { name: "Gateway", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/504230/5b74fdc02266a082409cb59543c2736c51d90896.jpg", desc: "Unlock gate Ch 4." }, { name: "Archaeology", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/504230/7544829d732b63de52eb0e68c796a68e8153c26f.jpg", desc: "Find hidden tape Ch 5." } ], tech: { engine: "MonoGame/XNA", verified: true, features: ["vsync", "linux", "drm-free", "controller"], unsupported: ["dlss", "ray-tracing", "multiplayer"] }, minSpecs: `<li><strong>OS:</strong> Win 7+</li><li><strong>CPU:</strong> Core i3 M380</li><li><strong>RAM:</strong> 2 GB</li><li><strong>GPU:</strong> OpenGL 3.0+</li><li><strong>HDD:</strong> 1.2 GB</li>`, playtime: 15.5, hltb: { story: 8, extras: 20, completionist: 50 } },
             "hades": { id: "hades", name: "Hades", executionType: "native", icon: "https://cdn.cloudflare.steamstatic.com/steamcommunity/public/images/apps/1145360/8a3fca36a00883e8066263ad35dd15d77a1f9abc.jpg", cover: "https://cdn1.epicgames.com/min/offer/1200x1600-1200x1600-e92fa6b99bb20c9edee19c361b8853b9.jpg", banner: "https://cdn2.unrealengine.com/Diesel%2Fblog%2FBlog+Posts%2FHades+Available+Now%2FEGS_BANNER_Hades-1900x600-f74ee6ebeaa5e14b420cdb691d129f246e253c95.jpg", trailer: "https://video.cloudflare.steamstatic.com/store_trailers/256801252/movie_max_vp9.webm?t=1600353465", screenshots: [ "https://shared.cloudflare.steamstatic.com/store_item_assets/steam/apps/1145360/ss_c0fed447426b69981cf1721756acf75369801b31.jpg", "https://shared.cloudflare.steamstatic.com/store_item_assets/steam/apps/1145360/ss_8a9f0953e8a014bd3df2789c2835cb787cd3764d.jpg", "https://shared.cloudflare.steamstatic.com/store_item_assets/steam/apps/1145360/ss_68300459a8c3daacb2ec687adcdbf4442fcc4f47.jpg" ], description: "Defy the god of the dead...", price: "$24.99", diskSizeGB: 15, totalDiskGB: 1024, reviews: { percent: 98, count: 205810, feed: [ "<strong>Stunning:</strong> Top-tier.", "<strong>Masterpiece:</strong> Addictive.", "<strong>GOTY Material:</strong> Best roguelike.", "<strong>Recommended:", "<strong>God Tier:</strong> Phenomenal VA." ] }, achievements: [ { name: "Escaped Tartarus", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1145360/062a2b7bdc156af9438bdc440a19833addd2ae38.jpg", desc: "Clear region 1." }, { name: "Escaped Asphodel", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1145360/202d5cd97dd3b727e0eaa8ffc02a62dcf67cd5d7.jpg", desc: "Clear region 2." }, { name: "Arms Collector", img: "https://cdn.cloudflare.steamstatic.com/steamcommunity/public/images/apps/1145360/c44928fe7cd58ab1de32bedc19ad8742e7fbd46b.jpg", desc: "Unlock all arms." } ], tech: { engine: "Proprietary", verified: true, features: ["vulkan", "dx11", "controller", "drm-free"], unsupported: ["dlss", "ray-tracing", "linux", "multiplayer"] }, minSpecs: `<li><strong>OS:</strong> Win 7+</li><li><strong>CPU:</strong> Dual Core 2.4GHz</li><li><strong>RAM:</strong> 4 GB</li><li><strong>GPU:</strong> 1GB VRAM/DX 10+</li><li><strong>HDD:</strong> 15 GB</li>`, playtime: 42.1, hltb: { story: 22, extras: 55, completionist: 100 } },
            "breathofthewild": {
                id: "breathofthewild", name: "Zelda: Breath of the Wild", executionType: "emulation",
                icon: "https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/73206bd9-257c-4f50-b1f3-59a306e24084/dftplbl-40fd5273-d11b-4b35-88dd-03af4d19cee3.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7InBhdGgiOiJcL2ZcLzczMjA2YmQ5LTI1N2MtNGY1MC1iMWYzLTU5YTMwNmUyNDA4NFwvZGZ0cGxibC00MGZkNTI3My1kMTFiLTRiMzUtODhkZC0wM2FmNGQxOWNlZTMucG5nIn1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmZpbGUuZG93bmxvYWQiXX0.1MhwhsvftTU0ytjisSAooxxFGZ5bQhYTEmZ0In37hbA", // UPDATED
                cover: "https://static.posters.cz/image/1300/pinturas-sobre-lienzo-the-legend-of-zelda-breath-of-the-wild-view-i111060.jpg", banner: "https://zelda.com/breath-of-the-wild/assets/media/wallpapers/mobile-1.jpg", trailer: null, screenshots: [ "https://d.ibtimes.co.uk/en/full/1524875/legend-zelda-breath-wild-screenshot.jpg", "https://images.nintendolife.com/screenshots/81288/large.jpg", "https://oyster.ignimgs.com/mediawiki/apis.ign.com/the-legend-of-zelda-hd/b/bb/Zora_20.jpg" ], description: "Step into a world of discovery...", price: "$59.99", diskSizeGB: 14.4, totalDiskGB: 1024, reviews: { percent: 97, count: 150000, feed: [ "<strong>Masterpiece:</strong> Benchmark.", "<strong>Incredible Freedom:", "<strong>Absolutely beautiful:", "<strong>Must Play:", "<strong>Revolutionary:" ] }, achievements: [], tech: { engine: "Proprietary", verified: null, features: ["open-world", "physics", "single-player", "controller"], unsupported: ["dlss", "ray-tracing", "multiplayer", "linux", "drm-free"] }, minSpecs: `<li><strong>Note:</strong> Requires Emulator</li><li><strong>CPU:</strong> i5/Ryzen 5+ Rec.</li><li><strong>RAM:</strong> 8GB+(16GB Rec.)</li><li><strong>GPU:</strong> Vulkan, GTX 1060/RX 580+ Rec.</li><li><strong>HDD:</strong> 14.4GB + Emulator</li>`, playtime: 68.2, hltb: { story: 50, extras: 98, completionist: 189 } },
            "tearsofthekingdom": {
                id: "tearsofthekingdom", name: "Zelda: Tears of the Kingdom", executionType: "emulation",
                icon: "https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/c78bc3fc-9f08-47ca-81ae-d89055c7ec49/dgzjc79-1a4bcc5d-fd59-45b1-a2a6-9802aacf92bb.png/v1/fill/w_512,h_512/the_legend_of_zelda___tears_of_the_kingdom_icon_v2_by_andonovmarko_dgzjc79-fullview.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9NTEyIiwicGF0aCI6IlwvZlwvYzc4YmMzZmMtOWYwOC00N2NhLTgxYWUtZDg5MDU1YzdlYzQ5XC9kZ3pqYzc5LTFhNGJjYzVkLWZkNTktNDViMS1hMmE2LTk4MDJhYWNmOTJiYi5wbmciLCJ3aWR0aCI6Ijw9NTEyIn1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.qxhDLl9Z42dM9LUZzL_MWBDqviWzObWPlM1moYf0uF0", // UPDATED
                cover: "https://assets.nintendo.eu/image/upload/f_auto,c_limit,w_960,q_auto:low/edrd2axuh6uxrldm3jm4", banner: "https://www.thebanner.org/sites/default/files/styles/social_media_thumbnail/public/2023-08/WCCFzeldatearsofthekingdom8.jpg?itok=mTaL1W-Z", trailer: null, screenshots: [ "https://cdn.hobbyconsolas.com/sites/navi.axelspringer.es/public/media/image/2023/02/zelda-tears-kingdom-2961270.jpg", "https://helios-i.mashable.com/imagery/articles/04N1x1QH4pfWF5AmSaRzcDW/hero-image.fill.size_1248x702.v1683732725.jpg", "https://www.japantimes.co.jp/uploads/imported_images/uploads/2023/05/np_file_228186.jpeg" ], description: "An epic adventure across land and skies...", price: "$69.99", diskSizeGB: 16.3, totalDiskGB: 1024, reviews: { percent: 96, count: 120000, feed: [ "<strong>Astounding:</strong> Builds upon greatness.", "<strong>Innovative:</strong> Fuse/Ascend.", "<strong>Vast & Deep:", "<strong>Highly Recommended:", "<strong>Pure Magic:" ] }, achievements: [], tech: { engine: "Proprietary", verified: null, features: ["open-world", "physics", "single-player", "controller", "crafting"], unsupported: ["dlss", "ray-tracing", "multiplayer", "linux", "drm-free"] }, minSpecs: `<li><strong>Note:</strong> Requires Emulator</li><li><strong>CPU:</strong> i5/Ryzen 5+ Rec.</li><li><strong>RAM:</strong> 16 GB+ Recommended</li><li><strong>GPU:</strong> Vulkan, GTX 1660/RX 5600XT+ Rec.</li><li><strong>HDD:</strong> 16.3 GB + Emulator</li>`, playtime: 75.0, hltb: { story: 59, extras: 110, completionist: 238 } },
            "reddeadredemption2": {
                id: "reddeadredemption2", name: "Red Dead Redemption 2", executionType: "native",
                icon: "https://cdn.cloudflare.steamstatic.com/steamcommunity/public/images/apps/1174180/5106abd9c1187a97f23295a0ba9470c94804ec6c.jpg",
                cover: "https://www.gtabase.com/igallery/4201-4300/RDR_2_Cover_PC-4213-1920.jpg",
                banner: "https://www.amd.com/content/dam/amd/en/images/games/red-dead-redemption-2/348038-red-dead-redemption-banner.jpg",
                trailer: "https://video.cloudflare.steamstatic.com/store_trailers/256767979/movie_max.webm?t=1574881964",
                screenshots: [ "https://shared.cloudflare.steamstatic.com/store_item_assets/steam/apps/1174180/ss_66b553f4c209476d3e4ce25fa4714002cc914c4f.jpg", "https://shared.cloudflare.steamstatic.com/store_item_assets/steam/apps/1174180/ss_668dafe477743f8b50b818d5bbfcec669e9ba93e.jpg", "https://shared.cloudflare.steamstatic.com/store_item_assets/steam/apps/1174180/ss_4ce07ae360b166f0f650e9a895a3b4b7bf15e34f.jpg" ],
                description: "America, 1899. Arthur Morgan...",
                price: "$59.99", diskSizeGB: 150, totalDiskGB: 1024,
                reviews: { percent: 91, count: 550000, feed: [ "<strong>Masterpiece:</strong> Storytelling.", "<strong>Incredible World:", "<strong>Must Play:</strong> Western epic.", "<strong>Detailed:", "<strong>Emotional:" ] },
                achievements: [ // RDR2 Achievements List (Many items!)
                    { name: "Just a Scratch", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/1d0bdc25d376a74b0ee37355ee32f9eb308dd90c.jpg", desc: "Complete 'Enter, Pursued by a Memory'." },
                    { name: "Back in the Mud", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/3f5b6b4295a58d39b7619e5723f94b8f475dd81e.jpg", desc: "Complete Chapter 1." },
                    { name: "Trusty Steed", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/e968b36e4c3fba5addab9f4d4a31ddf935cb2804.jpg", desc: "Reach max bonding level with a horse." },
                    { name: "Give to the Poor", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/db4c73fe207337b21d4112dcdf0e24b36d101792.jpg", desc: "Donate $250 to the gang tithing box." },
                    { name: "To Greener Pastures", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/cede247d21de983c4d0d8aed8b75d1324cac9bf3.jpg", desc: "Complete Chapter 2." },
                    { name: "Locked and Loaded", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/9f07d5b06a35ec4b44f7081de6851090d43ecdfb.jpg", desc: "Upgrade each available component for a single sidearm or longarm weapon." },
                    { name: "Take From the Rich", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/1ecb9a2efacd9822676a57221e770e294176bcb8.jpg", desc: "Rob or loot $250." },
                    { name: "Breakout", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/926ad55990bb91ebce118232aef4606e9fdd64e0.jpg", desc: "Red Dead Online: Complete the Intro." },
                    { name: "Settling Feuds", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/ab025f0eacc998f62125d7a7bb186e9fbdd95d24.jpg", desc: "Complete Chapter 3." },
                    { name: "Washed Ashore", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/a07e4dac160f638c24ac851ffc0aea19bc51f12d.jpg", desc: "Complete Chapter 4." },
                    { name: "No Traitors", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/79a6c1cb5ac1f88150802768ab8c6a7078d272c1.jpg", desc: "Complete Chapter 5." },
                    { name: "Third Time Lucky", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/70286589047c58568477e6ba124161d6047cd023.jpg", desc: "Complete 'Goodbye, Dear Friend'." },
                    { name: "Redemption", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/94fa0722da3453c6cd222b97b77880c29f7dc97c.jpg", desc: "Complete Chapter 6." },
                    { name: "Cowboy Builder", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/d2fdc9461799c466b1ff7a9f3666cd2dbb4f61e3.jpg", desc: "Complete 'A New Jerusalem'." },
                    { name: "Endless Summer", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/caca2e3bed70ec5ce18c7d7e9a261aef5cf55737.jpg", desc: "Complete the Epilogue." },
                    { name: "Extreme Personality", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/da06def2b4fd81d0e02beb4eee72f35666165b5f.jpg", desc: "Reach maximum or minimum Honor level." },
                    { name: "It was THIS Big!", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/2da795e555aea18f61a0963c7a53d1f0a3598080.jpg", desc: "Catch a fish weighing at least 16 lbs (7.3 kg)." },
                    { name: "Breaking and Entering", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/1e5b34e1120f9d7c05d5d3b30ff4404174297350.jpg", desc: "Recover the stash from 4 homesteads." },
                    { name: "Friends With Benefits", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/8f23138781fcfe026db01e662dc371e4989e77d7.jpg", desc: "Complete a Companion Activity in each camp." },
                    { name: "Getting Started", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/335e01c93fa8589cb324512f6cd512f9c7158aa6.jpg", desc: "Red Dead Online: Reach Rank 10." },
                    { name: "Pony Up", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/df915ba333f89296aed56a99a48bcabe8dba1577.jpg", desc: "Spend $5000 across all shops." },
                    { name: "Strength in Numbers", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/85e8caa42574e16fa1778fd690d483a5950c8913.jpg", desc: "Red Dead Online: Complete a Free Roam mission as part of a Posse with at least 2 members." },
                    { name: "Self Sufficient", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/5dbdc27157fb37733ac523d08a32033cd96715ce.jpg", desc: "Craft 30 unique items in Story Mode." },
                    { name: "Buckle Up", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/87d37fee2036caac90df6161a616557135a11253.jpg", desc: "Red Dead Online: Achieve 5 gold belt buckles from awards." },
                    { name: "Western Stranger", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/c97461b35c26b932a49485ff5ae47191fd181409.jpg", desc: "Complete 10 Stranger mission strands." },
                    { name: "Butchered", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/26f3176aa06edb773a62306861a12b45a4cb6db9.jpg", desc: "Red Dead Online: Sell 20 items to the Butcher." },
                    { name: "Hobby Horse", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/b9035447f996165e28534b3c44efbaa6d8e975f2.jpg", desc: "Play all mini games." },
                    { name: "Gun For Hire", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/1d64c48392a4a9b38a8118fd325498530e377c85.jpg", desc: "Red Dead Online: Accept 10 Free Roam missions from characters around the world." },
                    { name: "Lending a Hand", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/66e9c4410bb51cfe5b7764e4b8af6ea0193eaa04.jpg", desc: "Complete all optional Honor story missions." },
                    { name: "Picked to Perfection", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/ea928b474186033ac7a82eea19e0d1940f40d34a.jpg", desc: "Red Dead Online: Pick 25 Herbs." },
                    { name: "Errand Boy", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/85fa32d0b3d635e177ad68ccc5665a115c0e8391.jpg", desc: "Deliver 5 camp companion item requests." },
                    { name: "Master Craftsman", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/d7c4bb70fadf697ce7a0293a5cbb04c82e4715fd.jpg", desc: "Red Dead Online: Craft 20 items (excluding ammo)." },
                    { name: "Series Major", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/9f66223e68c7596b2cfed77b8cdaf2fdc2872f54.jpg", desc: "Red Dead Online: Take part in a Series." },
                    { name: "Posse Up", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/fc90e95976838f7a277f19c3cabd46b66d6be0d0.jpg", desc: "Red Dead Online: Form a Persistent Posse." },
                    { name: "Artificial Intelligence", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/2c1db095cc0aa079bf967a38e967846754ca87a3.jpg", desc: "Discover the fate of Marko Dragic." },
                    { name: "Collector's Item", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/56cb09991e4ceb05d09ecc6ee6d06e46eb3b4101.jpg", desc: "Complete one of the Collectable strands." },
                    { name: "Notorious", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/f23eb5e7531ff94d44c31bedc0ec1f6365f4504d.jpg", desc: "Red Dead Online: Reach Rank 50." },
                    { name: "Home Comforts", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/ead550cec661a7a0b9e9b38bf92f91848e424860.jpg", desc: "Red Dead Online: Purchase 5 camp improvements." },
                    { name: "All's Fair", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/178f91958459e5a06885a702ed96077679fe30ac.jpg", desc: "Red Dead Online: Successfully counter a rival Posse's Free Roam mission." },
                    { name: "Paying Respects", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/901fc090f41e93f4f798e81e06ab226d06fb158c.jpg", desc: "Find the graves of each of your fallen companions." }, // Added plausible desc
                    { name: "Skin Deep", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/86b6b74c73308cfec94f6e05c191c7ce7e857f3f.jpg", desc: "Skin every species of animal in Story Mode." },
                    { name: "Zoologist", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/7d617edd1fe18419760f6f365a274c4fbe40567c.jpg", desc: "Study every animal across all states in Story Mode." },
                    { name: "Eventful", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/942df6d288001ed3cd95f1b4afe61f1b9d3230f3.jpg", desc: "Red Dead Online: Play 5 Free Roam Events." },
                    { name: "Best in the West", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/7685a51c88bc2e5ae61b20660030467a376b56f1.jpg", desc: "Attain 100% completion." },
                    { name: "Non-Regulation", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/2cfcf05c99e1f9424c97bd2fd08b9120510aa7d1.jpg", desc: "Red Dead Online: Craft 25 pieces of ammunition." },
                    { name: "Horses for Courses", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/013e906b76174844bd3d43b9fa5ea32233231bda.jpg", desc: "Red Dead Online: Concurrently own 5 horses." },
                    { name: "Bountiful", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/db61903a5678931086307c8e07ef5cdf5f9859e0.jpg", desc: "Survive 3 days holding a bounty of $250 in all states." },
                    { name: "It's Art", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/d31cc96a1ae81d5c9859d2a782268dfe86e917b1.jpg", desc: "Find a permanent home for the squirrel statue." }, // Added plausible desc
                    { name: "The Real Deal", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/286dcd75cc2958570f6c18b0ac1d45aec3a60f29.jpg", desc: "Red Dead Online: Achieve MVP 3 times (in a round with at least 4 players)." },
                    { name: "Gold Rush", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/2e87c6247c68c13041833a9f4993449b7ef0e4bf.jpg", desc: "Earn 70 Gold Medals in Story missions." },
                    { name: "Grin and Bear it", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1174180/aef9a5ba1605f7d31a6a5aaf9aa061a800ca2a65.jpg", desc: "Survive 18 bear attacks and kill the bear each time in Story Mode." }
                ],
                tech: { engine: "RAGE", verified: true, features: ["dx12", "vulkan", "controller", "hdr", "dlss", "fsr"], unsupported: ["ray-tracing"] }, minSpecs: `<li><strong>OS:</strong> Win 10+</li><li><strong>CPU:</strong> i5-2500K/FX-6300</li><li><strong>RAM:</strong> 8 GB</li><li><strong>GPU:</strong> GTX 770/R9 280</li><li><strong>HDD:</strong> 150 GB</li>`, playtime: 88.5, hltb: { story: 50, extras: 80, completionist: 181 }
             },
            "persona5royal": {
                id: "persona5royal", name: "Persona 5 Royal", executionType: "native",
                icon: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/2f868d8c16fc357dc7122d440b9de3916e36e6fa.jpg",
                cover: "https://e.snmc.io/lk/lv/x/6de871a18ede88cd78e5c8af5752e586/8065088",
                banner: "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/1687950/header.jpg?t=1733297467",
                trailer: "https://video.fastly.steamstatic.com/store_trailers/256912707/movie_max_vp9.webm?t=1666698724",
                screenshots: [
                   "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/1687950/ss_663171dc3afce8fe987e57e8659f91b69faa39bc.1920x1080.jpg?t=1733297467",
                   "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/1687950/ss_a3258aba84ae2f2ff13a02a160f7495bfc152adb.1920x1080.jpg?t=1733297467",
                   "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/1687950/ss_ddcc016b8e5c434ccbd1a89c0157ce73acf905ae.1920x1080.jpg?t=1733297467"
                ],
                description: "Don the mask and join the Phantom Thieves of Hearts...",
                price: "$59.99", diskSizeGB: 41, totalDiskGB: 1024,
                reviews: { percent: 96, count: 65864, feed: [ "<strong>Phenomenal:</strong> Modern classic.", "<strong>Stylish AF:", "<strong>Incredible Music:", "<strong>Must-Play RPG:", "<strong>So Much Content:" ] },
                achievements: [
                    { name: "Spirit of Rebellion", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/7ea4caedfa595f3c1c72afc6bcef99af974a7c84.jpg", desc: "Obtained Arsène." },
                    { name: "I am Thou...", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/5d54cc90c41b10a0726d49d376dc210ccf22c59f.jpg", desc: "Obtained a Persona through negotiation." },
                    { name: "You'd Better Hang On!", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/8b621bdd245f43d207af7f4961520f2e3f21194e.jpg", desc: "Used the grappling hook." },
                    { name: "Tactical Teamwork", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/73bdccd8b30edaa5ee729d3dd127b59f11a64126.jpg", desc: "Performed a Baton Pass." },
                    { name: "Technician", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/29f54f389723ce2126042f2af67370c469560a53.jpg", desc: "Triggered a Technical." },
                    { name: "Let's Blow It Up", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/957bb1f848e5b3673654c5ea9287e1dd457189c5.jpg", desc: "Defeated enemies via Disaster Shadow explosion." },
                    { name: "Castle of Lust: Seized", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/d476c69114062761fb91eda32759271d69e0cbe6.jpg", desc: "Completed the Castle Palace." },
                    { name: "A Deadly Debut", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/667101891026acf873214dc73e1498c510dcd3f8.jpg", desc: "Performed a Guillotine execution." },
                    { name: "Phantom Thieves: Assemble!", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/b0381e11b7a90e4882f674596d0f742f20b695c1.jpg", desc: "Established your own squad of thieves." },
                    { name: "One Step at a Time", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/fd92e7654ce78db25bd3ed2b02dab55349bf0da3.jpg", desc: "Completed a Mementos request." },
                    { name: "Tokyo Tourist", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/b48585ebdf329a2b5474c0f2ae235f0f1d397ae5.jpg", desc: "Went to a hangout spot with someone." },
                    { name: "Batter Up!", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/dc58efa8539e1a606af82d98b15b729a5f7fd50c.jpg", desc: "Scored a hit at the batting cages." },
                    { name: "Talent Thief", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/4d85d5640b5479b7cb3a70af8a1c9b640a6a1d9a.jpg", desc: "Obtained a Skill Accessory from a Palace ruler." },
                    { name: "Jose's Favorite Customer", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/c8906b52658005e8ab5df984063eb6b592fe9f15.jpg", desc: "Traded in flowers while in Mementos." },
                    { name: "Punch That Clock!", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/3109aba1ce8d442b834c58a8fa77ed44969adb7e.jpg", desc: "Worked a part-time job." },
                    { name: "The Phantom Philatelist", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/ce86baf891d03e942c999555ec51bdbe44bc513d.jpg", desc: "Traded in stamps while in Mementos." },
                    { name: "Museum of Vanity: Repossessed", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/3f4acf1eeacd464483cf6529ca758120e7c623ee.jpg", desc: "Completed the Museum Palace." },
                    { name: "Leblanc Buffer", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/fd2686e30ea2148112a5b63fdcd257166a6e8a22.jpg", desc: "Cleaned up in Leblanc." },
                    { name: "The Deviated Cognition", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/ea0ce4a0b62fc6c8afd1682c2296ffc1685c9737.jpg", desc: "Encountered a deviation in Mementos." },
                    { name: "It's Showtime!", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/2010603e5f3dba4f66b78653bef71c08977de1c5.jpg", desc: "Performed a Showtime attack." },
                    { name: "A Grand Experiment", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/fafcd08cf8200cfd2f7b5d8909a14a07436f8e10.jpg", desc: "Performed an Electric Chair execution." },
                    { name: "Accident-Prone", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/5b6861b69d7cd1a9a143e7615c852feabdd877ab.jpg", desc: "Performed an execution during a Fusion Alarm." },
                    { name: "Bank of Gluttony: Cleaned Out", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/86edec9981f95cb2d8e6a94fad50fe629606b216.jpg", desc: "Completed the Bank Palace." },
                    { name: "Dartslinger", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/9ac20665620940a80a9f1bb8d0459ac55bcc027d.jpg", desc: "Played a game of darts." },
                    { name: "The Purpose of a Thief", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/2737c010e4fc6230b2cb378a69df910ce6fa9b4a.jpg", desc: "Obtained a Treasure Demon." },
                    { name: "Trash Into Treasure", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/ce08767cbdbcf119d4ef4916f48632d32b083389.jpg", desc: "Sold old clothing at Furugi no Neuchi." },
                    { name: "Pyramid of Wrath: Plundered", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/22064cb410b8f8721827b016de7a661efe035963.jpg", desc: "Completed the Pyramid Palace." },
                    { name: "True Confidence", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/1b4b2b5c97044194bbacb599208dd79502fc55c0.jpg", desc: "Maxed out one of your Confidants." },
                    { name: "Success Built on Sacrifice", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/1480e94c2962b04703e8d7a5ce220542ccb64ea3.jpg", desc: "Performed a Gallows execution." },
                    { name: "A Hustler's Journey", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/d75fdb4f65bba958e8f1c2829250dc60a742adad.jpg", desc: "Played a game of billiards." },
                    { name: "My Closest Partner", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/3e8a7148dd5bcf9067da6e833ec9f627e04096d4.jpg", desc: "Entered a special relationship." },
                    { name: "Spaceport of Greed: Obliterated", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/cad5270e013516eec71b99e1a8a283b5de0ff427.jpg", desc: "Completed the Spaceport Palace." },
                    { name: "Professional Modification", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/f71f1ff6d6ff93c2ec750f9de2b8afc432b3d58c.jpg", desc: "Customized a gun." },
                    { name: "Casino of Jealousy: Bankrupted", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/a2bdd7966a74191665cbf41b7a9f5b79791cdcde.jpg", desc: "Completed the Casino Palace." },
                    { name: "A Most Studious Disguise", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/7237f4f5e4411ce6c339f91bd8eb7f11d9e779f3.jpg", desc: "Scored the highest on your exams." },
                    { name: "Efficient Executioner", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/f4aa6d7b4fed17a3fd457fda160c8c3ee4bca2b4.jpg", desc: "Performed a Group Guillotine execution." },
                    { name: "Getting the Vapors", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/12244b0f8314ba7c5b5c750a64f79eb0689bbcff.jpg", desc: "Couldn't take the heat in the bathhouse." },
                    { name: "Cruiser of Pride: Capsized", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/4edaadd302a0637f26c34c8517cc41e9b57f7f1a.jpg", desc: "Completed the Cruiser Palace." },
                    { name: "The Thorough Trickster", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/57d43d414458d90133fab9542774c461713c7ac2.jpg", desc: "Completed Mementos." },
                    { name: "Easy Money", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/7c4510e44f63dee3253f2a706fc247b71faabb8a.jpg", desc: "Won the lottery." },
                    { name: "A Night in Kichijoji", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/2a3e4138799a5e69356b74bdd665248b0ba92d9f.jpg", desc: "Attended the jazz club." },
                    { name: "Pure Perfection", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/4a0ae5aed139c00780b7ff0e92cab0755c469bd5.jpg", desc: "Maxed out all social stats." },
                    { name: "Awakening the Phantom Thieves", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/bcfde0bde470cf2fe28d133812936a00bd7fc873.jpg", desc: "Evolved a party member's Persona." },
                    { name: "The Path Chosen", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/5919ad1a9d6c2e41ba4046c96e368bf6fdbfbe3d.jpg", desc: "Watched the ending." },
                    { name: "A Serene Experience", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/5a2280c271acbe852fdb931849244bfbcb423d5f.jpg", desc: "Visited a temple." },
                    { name: "The Search for Power", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/34a0090e407377e48115d95fcfa7e42425df1ef5.jpg", desc: "Completely changed the cognition of Mementos." },
                    { name: "Intensive Training", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/e1c3179d50a9e3fe1bf594b226243e485a63c041.jpg", desc: "Used Incense on a Persona in Lockdown." },
                    { name: "Take Back the Future", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/7a1ee1b8e6488cd30a59ec506db58963eb347c64.jpg", desc: "Completed the final Palace." },
                    { name: "Going Against the Crane", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/43237652ae624aef50e10e05bd3893c64be43bcf.jpg", desc: "Scored a prize in the crane game." },
                    { name: "Angler's Debut", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/6d6972cfbb37ad208f4940dabed56ee0a3cc0ec6.jpg", desc: "Passed time at the fishing pond." },
                    { name: "Unsurpassed Rebel", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/046f086cdac38026663089a2295efbd9cb5e10be.jpg", desc: "Conquered the Reaper." },
                    { name: "Master of Akihabara", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/a9558c5687e44d07643ae0eedfe60b93239acb99.jpg", desc: "Ordered from the special menu at the maid café." },
                    { name: "The Phenomenal Phantom Thief", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1687950/3f258c23667e8dc4fa24951ae4829253a1de0a5f.jpg", desc: "Unlocked all achievements." }
                ],
                tech: { engine: "ATLUS Internal", verified: true, features: ["JRPG", "Story Rich", "Turn-Based Combat", "Anime", "controller", "Steam Cloud"], unsupported: ["ray-tracing", "linux"] },
                minSpecs: `<li><strong>OS:</strong> Windows 10</li><li><strong>CPU:</strong> i7-4790 / Ryzen 5 1500X</li><li><strong>RAM:</strong> 8 GB</li><li><strong>GPU:</strong> GTX 650 Ti (2GB) / R7 360 (2GB)</li><li><strong>HDD:</strong> 41 GB</li>`,
                playtime: 112.3, hltb: { story: 101, extras: 115, completionist: 132 }
            },
            "persona3reload": {
                id: "persona3reload", name: "Persona 3 Reload", executionType: "native",
                icon: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/2161700/2aeb189b126f766bb5930f725fbdcdd171a93c56.jpg",
                cover: "https://static.wikia.nocookie.net/megamitensei/images/f/ff/Persona_3_Reload_Cover_Logoless.jpg/revision/latest",
                banner: "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/2161700/header.jpg?t=1741697885",
                trailer: "https://video.fastly.steamstatic.com/store_trailers/256997671/movie_max_vp9.webm?t=1706853523",
                screenshots: [
                   "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/2161700/ss_7017244fb8319ba927a0ef414959b95a6164356f.1920x1080.jpg?t=1741697885",
                   "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/2161700/ss_cfe4b9124ea5e815e7981e3ac29a72a02fd48239.1920x1080.jpg?t=1741697885",
                   "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/2161700/ss_c123d3e9360f030e6600db27311586d033f65ff7.1920x1080.jpg?t=1741697885",
                   "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/2161700/ss_f51fc26c627816bbd87011ca278b1fbbda2d6bc8.1920x1080.jpg?t=1741697885"
                ],
                description: "Dive into the Dark Hour and awaken the depths of your heart...",
                price: "$69.99", diskSizeGB: 30, totalDiskGB: 1024,
                reviews: { percent: 95, count: 27297, feed: [ "<strong>Overwhelmingly Positive:</strong> Incredible Remake!", "<strong>Must Play:", "<strong>Peak Fiction:", "<strong>Phenomenal Music:", "<strong>Gorgeous Visuals:" ] },
                achievements: [
                   { name: "The Steadfast One", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/2161700/5a0be4e98706d45859f3d4c406390de254fb47a2.jpg", desc: "Obtain Orpheus." },
                   { name: "Empowered Protector", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/2161700/d6d3355c5d8c54d1e63a7451c2251b3387725a0f.jpg", desc: "Create Palladion." },
                   { name: "Path to Salvation", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/2161700/3575a9f250c867eebc28bbdab3df4eef4f0c991d.jpg", desc: "Fuse Messiah." }
                ],
                tech: {
                    engine: "Unreal Engine", verified: true,
                    features: ["JRPG", "Story Rich", "Turn-Based Combat", "Anime", "Dating Sim", "Single-player", "controller", "Steam Cloud"],
                    unsupported: ["ray-tracing", "multiplayer", "linux"]
                },
                minSpecs: `<li><strong>OS:</strong> Windows 10 (64-bit)</li><li><strong>CPU:</strong> Intel Core i5-2300 / AMD FX-4350</li><li><strong>RAM:</strong> 8 GB</li><li><strong>GPU:</strong> NVIDIA GeForce GTX 650 Ti (2GB) / AMD Radeon HD 7850 (2GB)</li><li><strong>DirectX:</strong> Version 12</li><li><strong>HDD:</strong> 30 GB</li>`,
                playtime: 75.0, hltb: { story: 62, extras: 80, completionist: 125 }
            },
            "persona4golden": {
                id: "persona4golden", name: "Persona 4 Golden", executionType: "native",
                icon: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/295e86f2d5393325f38f33777b357d86e23c751d.jpg",
                cover: "https://image.api.playstation.com/vulcan/ap/rnd/202211/1812/UMxh8ivoTvoWEjXH0WSFsr70.jpg",
                banner: "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/1113000/header.jpg?t=1704380046",
                trailer: "https://video.fastly.steamstatic.com/store_trailers/256923856/movie_max_vp9.webm?t=1674106968",
                screenshots: [
                   "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/1113000/ss_eaa97afeaed3e89d3032e8bb60cb8d6f331f241d.1920x1080.jpg?t=1704380046",
                   "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/1113000/ss_c92cef1e572183055dab3d8bcdcbc5fe55deb0cc.1920x1080.jpg?t=1704380046",
                   "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/1113000/ss_949196116c67aa963863a94def5a810a6d12979c.1920x1080.jpg?t=1704380046"
                ],
                description: "A coming of age story that sets the protagonist and his friends on a journey kickstarted by a chain of serial murders.",
                price: "$19.99", diskSizeGB: 14, totalDiskGB: 1024,
                reviews: { percent: 97, count: 64485, feed: [ "<strong>Overwhelmingly Positive:</strong> Masterpiece!", "<strong>Peak JRPG:", "<strong>Incredible Story & Characters:", "<strong>Timeless Classic:", "<strong>Best Persona?:" ] },
                achievements: [ // --- UPDATED P4G ACHIEVEMENTS ---
                    { name: "The Other Self", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/d38661052c70338e7853d7fa9c9e0462608bbb4c.jpg", desc: "Obtain the Persona Izanagi." },
                    { name: "Advantage Mine", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/ac47911c524d8f7ed52fd3dba787dec8cf4ff7be.jpg", desc: "Enter a battle with Player Advantage." },
                    { name: "A Prince Appears", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/5198e5c30d8c1881d0934f23d53f5fb0efd985da.jpg", desc: "Rescue Yukiko Amagi." }, // Added assumed description
                    { name: "Grasping at Greed", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/c6c0360238508736fbfa5b78362c1bf430586b33.jpg", desc: "Defeat a Golden Hand." },
                    { name: "Fashion Plate", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/fa4e584399cff16c91f32016ca25c9efcd0e31d7.jpg", desc: "Fight a battle in costume." },
                    { name: "A Favor for Marie", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/005b7caea2ce7b25ab049697b59761a0a374310f.jpg", desc: "Register a Skill Card." },
                    { name: "Tactical Fighter", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/4363e0c527ee7c88a89992bfb97d4d7d79c6e3a7.jpg", desc: "Exploit enemy weaknesses 100 times." },
                    { name: "A True Man's Stand", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/c40ed4f04d9f9bb98b2a7407f1c7a9cfcbbea702.jpg", desc: "Rescue Kanji Tatsumi." }, // Added assumed description
                    { name: "Skilled Commander", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/f302e1bfea103c74007564f72147e9b7d66ed2e3.jpg", desc: "Perform 50 All-Out Attacks." },
                    { name: "Persona Shopper", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/65e75d6cbf1e9e0e5476c8794fa8088ed9c1afc3.jpg", desc: "Buy a Persona from the Compendium." },
                    { name: "Displaying Adaptability", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/0a1bd43fdcbb6f6d76c74110ce46fd51160067d8.jpg", desc: "Switch Personas 5 times in 1 battle." },
                    { name: "The Lounge Is Closed", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/38184c401c7e8267d6f10458ce02bd8d4f7a5da6.jpg", desc: "Rescue Rise Kujikawa." }, // Added assumed description
                    { name: "A True Bond", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/8e398d3ded97ade63708bcd9a3593ac32791fd27.jpg", desc: "Max out a Social Link." },
                    { name: "Granter of Your Desires", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/46d3c17ff77ef32bfecf4c4db35ef13d8127d1c7.jpg", desc: "Buy 5 things from Tanaka's Amazing Commodities." },
                    { name: "Head of the Class", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/452e0abc20182e84962d76f970ce666613de0230.jpg", desc: "Rank #1 in your class on an exam." },
                    { name: "Game Over", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/4f641693274a9736038a319489ec2f03e0fac6bf.jpg", desc: "Rescue Mitsuo Kubo." }, // Added assumed description
                    { name: "A Special Lady", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/5df9e71c7b679467748ed958649e581d5d5fb129.jpg", desc: "Enter a special relationship with someone." },
                    { name: "Lucky Me!", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/31b02eeff15581f7aacbe54f8fedec0f9a0cba37.jpg", desc: "Win a prize from the vending machine." },
                    { name: "Going Nova", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/27f4b6c46c92e440e2bbb8afddf6706628289087.jpg", desc: "Deal over 999 damage in 1 attack." },
                    { name: "An Acquired Taste", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/313190ed675928bec78662fd0ebc080909cb82a8.jpg", desc: "Drink the coffee at Chagall Café." },
                    { name: "Boarded-Up Lab", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/9f02c04df0df32b8e54ecf6d7349e86de4d48bbd.jpg", desc: "Rescue Naoto Shirogane." }, // Added assumed description
                    { name: "The Return of the Angels", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/af6a4d7bb324fa77c211b33041ae66be53761133.jpg", desc: "Rescue Nanako Dojima." }, // Added assumed description
                    { name: "The Nose Doesn't Always Know", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/ce38bb70da05ca3da73c8127bc4ecd8e9c683619.jpg", desc: "Experience a fusion accident." },
                    { name: "It's Working Today", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/662864d38bf77a08b584904a018327daff0af07b.jpg", desc: "Buy an item from the Capsule Machine." },
                    { name: "Fill Your Hand", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/da449a0ec36e6d3abe867c06c40b78e9286eded4.jpg", desc: "Get 50 Sweep Bonuses." },
                    { name: "Breaking Through the Fog", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/703187cdf797621c8a8644761719c0e59b047a97.jpg", desc: "Defeat Ameno-sagiri." }, // Added assumed description
                    { name: "Movie Buff", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/ca044896da3477684e021da666b87eadcd07d454.jpg", desc: "Go to 3 movies at 30 Frame." },
                    { name: "Mr. Perfect", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/a37322754f719a549c6e063077bb3ec9b09e34a2.jpg", desc: "Max out all social qualities." },
                    { name: "Special Fusion Expert", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/da8923110fbefd0c77a4fa11df628128d67ecff8.jpg", desc: "Use 4 or more Personas in a special fusion." }, // Added assumed description
                    { name: "Bond Maniac", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/f625b0686927fe412f00174057efa407212f2b8b.jpg", desc: "Max out 10 Social Links." },
                    { name: "Moderate Bookkeeper", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/6cc83f4a48d50fb6fd74cee4a7703fa12172d3bb.jpg", desc: "Register over 50% of the Compendium." },
                    { name: "Seize the Moment", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/13ff763391bbcc4f2bc11bf8e041f0e80c26cc48.jpg", desc: "Buy a special croquette from Sozai Daigaku." },
                    { name: "Cooking With Gas", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/e564bc32afad55635dd1529d66af1f3da5d27321.jpg", desc: "Make 5 perfect boxed lunches." },
                    { name: "Bug Hunter", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/85d430b91423b2b8cbcbfe8c783e6cf33b10bd8d.jpg", desc: "Swing the net with perfect timing." },
                    { name: "Welcome Back", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/93ac780aad9001321e2ab55a7690273c79927054.jpg", desc: "Rescue Marie." }, // Added assumed description
                    { name: "Fusion Expert", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/3be85c333025b559d96b7f51dcc724a9fa75be09.jpg", desc: "Perform 50 Persona fusions." },
                    { name: "The Truth In Your Hands", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/e6a2dcb5ea47fff73fd1f2f7b6f15e8a4089104e.jpg", desc: "Defeat Izanami-no-Okami." }, // Added assumed description
                    { name: "Food Fighter", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/1d494ab2c8cb73f88451451785317675ef467d3d.jpg", desc: "Finish Aiya's special dish." },
                    { name: "Fishing Master", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/0771eafd35db4f7289cc0bdb484286efff84bf26.jpg", desc: "Catch the Sea Guardian." },
                    { name: "The Reaper Becomes the Reaped", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/2892ec5ba2e46b9b0f8cac651eda81dd618674bf.jpg", desc: "Defeat The Reaper." }, // Added assumed description
                    { name: "Big Bro is Worried", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/f0d0129e6e963c5e7eb6eec65372ae4aad47acfe.jpg", desc: "Visit Nanako in the hospital 3 times." }, // Added assumed description
                    { name: "Legend of Inaba", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/4c65ba0a37d902342938a2e2458476d9251b5af6.jpg", desc: "Max out all Social Links." },
                    { name: "Card Collector", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/c524d04c8b9576b3e95879a20ec619640b441b0e.jpg", desc: "Register 100 Skill Cards." },
                    { name: "Compulsive Reader", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/5ce677747ac869154f78dc74bff1eeca62e24f60.jpg", desc: "Read all books." },
                    { name: "Hardcore Risette Fan", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/8794d302679c4a6167f31d3aa810e05da75c2b05.jpg", desc: "Hear 250 of Rise's navigation lines." },
                    { name: "A New Quiz King", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/c74cb22ae99b38e76cbe2e32c04152df37419be9.jpg", desc: "Win the Miracle Quiz Finals." },
                    { name: "Thorough Bookkeeper", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/f8864dcb1c85b87863c414a0a0e6eb27cbe11abd.jpg", desc: "Complete the Persona Compendium." },
                    { name: "The Power of Truth", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/915c92cb5df202808f9f6fea40f6330ddb662240.jpg", desc: "Create Izanagi-no-Okami." }, // Added assumed description
                    { name: "One Who Has Proven Their Power", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/413cfb397da00793afc127a01dd11a45dc391680.jpg", desc: "Defeat Margaret." }, // Added assumed description
                    { name: "Golden Completed", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/1113000/c1a02cc344cbcb6d900fb9b06a0eecff31cd9c77.jpg", desc: "Earn all achievements" }
                ], // --- END OF P4G ACHIEVEMENTS ---
                tech: {
                    engine: "ATLUS Internal", verified: true,
                    features: ["JRPG", "Story Rich", "Turn-Based Combat", "Anime", "Dating Sim", "Single-player", "controller", "Steam Cloud"],
                    unsupported: ["ray-tracing", "multiplayer", "linux"]
                },
                minSpecs: `<li><strong>OS:</strong> Windows 8.1+ (64-bit)</li><li><strong>CPU:</strong> Intel Core 2 Duo E8400 / AMD Phenom II X2 550</li><li><strong>RAM:</strong> 2 GB</li><li><strong>GPU:</strong> NVIDIA GeForce GTS 450 / AMD Radeon HD 5770</li><li><strong>DirectX:</strong> Version 11</li><li><strong>HDD:</strong> 14 GB</li>`,
                playtime: 90.5, hltb: { story: 69, extras: 76, completionist: 122 }
            },
            "balatro": {
                id: "balatro", name: "Balatro", executionType: "native",
                icon: "https://cdn.cloudflare.steamstatic.com/steamcommunity/public/images/apps/2379780/b6018068070ab0e23561694c11f7950dd6f4c752.jpg",
                cover: "https://cdn.mobygames.com/covers/19339043-balatro-xbox-one-front-cover.png",
                banner: "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/2379780/header.jpg?t=1741618762",
                trailer: "https://video.fastly.steamstatic.com/store_trailers/256974582/movie_max_vp9.webm?t=1696871174",
                screenshots: [
                   "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/2379780/ss_d17a3adc6176c7f99e0dc31c49f4764f137e6374.1920x1080.jpg?t=1741618762",
                   "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/2379780/ss_4862112e5030f74a5818cd4c31347d699ac5adf3.1920x1080.jpg?t=1741618762",
                   "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/2379780/ss_3be65a7dd3be072d567e11883d208861a7e959fa.1920x1080.jpg?t=1741618762",
                   "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/2379780/ss_e32ac94d7d1d6be7dd015d78f2b52aeb4cc282ed.1920x1080.jpg?t=1741618762"
                ],
                description: "The poker roguelike. Balatro is a hypnotically satisfying deckbuilder where you play illegal poker hands...",
                price: "$13.99", diskSizeGB: 0.15, totalDiskGB: 1024,
                reviews: { percent: 98, count: 112512, feed: [ "<strong>Incredibly Addictive!", "<strong>Best Deckbuilder Ever?", "<strong>Just one more run...", "<strong>Ingenious Design!", "<strong>Perfect for Deck!" ] },
                achievements: [
                   { name: "You Get What You Get", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/2379780/ef51600bad9ee0f338cde583d16a786ee3032536.jpg", desc: "Discover your first Joker." },
                   { name: "Flushed", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/2379780/f72d11c67a949f737fe19e85b205d267fbd455dd.jpg", desc: "Win a run with the Flush deck." },
                   { name: "Rule Breaker", img: "https://cdn.fastly.steamstatic.com/steamcommunity/public/images/apps/2379780/aae8438a6f5b9b719b1027052f05727cdcd4b634.jpg", desc: "Play a five-card hand with 4 cards." }
                ],
                tech: {
                    engine: "LÖVE", verified: true,
                    features: ["Card Game", "Roguelike", "Deckbuilder", "Single-player", "Strategy", "controller", "Steam Cloud", "macOS"],
                    unsupported: ["ray-tracing", "multiplayer", "linux"]
                },
                minSpecs: `<li><strong>OS:</strong> Windows 7+ (x64) / macOS 11+</li><li><strong>CPU:</strong> Intel Core i3</li><li><strong>RAM:</strong> 1 GB</li><li><strong>GPU:</strong> OpenGL 2.1 compatible</li><li><strong>HDD:</strong> 0.15 GB</li>`,
                playtime: 55.2, hltb: { story: 1, extras: 40, completionist: 80 }
            },
            "undertale": {
                id: "undertale",
                name: "Undertale",
                executionType: "native",
                icon: "https://cdn.cloudflare.steamstatic.com/steamcommunity/public/images/apps/391540/2ce672b89b63ec1e70d2f12862e72eb4a33e9268.jpg",
                cover: "https://pics.filmaffinity.com/undertale-344809895-large.jpg",
                banner: "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/391540/header.jpg?t=1579096091",
                trailer: "https://video.fastly.steamstatic.com/store_trailers/256655616/movie_max.webm?t=1447377566",
                screenshots: [
                    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/391540/ss_6ded97a2c98473ac1e8a2b3c1419d93fb31b1186.1920x1080.jpg?t=1579096091",
                    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/391540/ss_b9018c41cea2bdfb150609bedfca99b16a5af02a.1920x1080.jpg?t=1579096091",
                    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/391540/ss_b9ec4c53a8ed37f764649c970757c0a1f4948ec1.1920x1080.jpg?t=1579096091",
                    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/391540/ss_edab41f7c9fa287b0d90ebfa3b9219fec6e1b3ed.1920x1080.jpg?t=1579096091",
                    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/391540/ss_a11393d4b437ca75c10521f6baf53fbba9006f0f.1920x1080.jpg?t=1579096091",
                    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/391540/ss_85d6f0db4b5d6207534120c4b51e37dfd2f8dd83.1920x1080.jpg?t=1579096091",
                    "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/391540/ss_9025a366676c26046b1d08e94ab1a73406aa11db.1920x1080.jpg?t=1579096091"
                ],
                description: "UNDERTALE! The RPG game where you don't have to destroy anyone.",
                price: "$9.99",
                diskSizeGB: 0.2,
                totalDiskGB: 1024,
                reviews: {
                    percent: 96,
                    count: 234365,
                    feed: [
                        "<strong>Overwhelmingly Positive:</strong> Masterpiece!",
                        "<strong>Must Play:</strong> Unique & Charming.",
                        "<strong>Iconic Soundtrack:",
                        "<strong>Story Rich:",
                        "<strong>Choices Matter:"
                    ]
                },
                achievements: [],
                tech: {
                    engine: "GameMaker Studio",
                    verified: null, // Playable
                    features: ["RPG", "Single-player", "Pixel Graphics", "Great Soundtrack", "Story Rich", "controller", "Steam Trading Cards", "linux", "macos", "Funny", "Choices Matter", "Multiple Endings"],
                    unsupported: ["Multiplayer", "Ray Tracing", "DLSS"]
                },
                minSpecs: `<li><strong>OS *:</strong> Windows XP, Vista, 7, 8, or 10<br></li><li><strong>Memory:</strong> 2 GB RAM<br></li><li><strong>Graphics:</strong> 128MB<br></li><li><strong>Storage:</strong> 200 MB available space</li>`,
                playtime: 25.5,
                hltb: { story: 7, extras: 11, completionist: 25 }
            }
        };

        const communityContent=[{id:"ena_guide_1",image:"https://images.steamusercontent.com/ugc/28816881405920894/D086C0F5F12AD4972EAB5B0EED6361D6A58660E9/?imw=512&&ima=fit&impolicy=Letterbox&imcolor=%23000000&letterbox=false",title:"ENA: Dream BBQ Achievement Guide (Ch 1)",text:"<p><strong>From: ENA Hub</strong></p><p>Simple guide on how to unlock all achievements...</p>",gameName:"ENA: Dream BBQ"},{id:"gmod_workshop_1",image:"https://images.steamusercontent.com/ugc/47957179822683890/476E5976481B073A8850DC979605DA8297B8E571/?imw=512&&ima=fit&impolicy=Letterbox&imcolor=%23000000&letterbox=false",title:"L4D styled soldier (Playermodel/Ragdoll)",text:"<p><strong>From: GMod Workshop</strong></p><p>New workshop item.</p>",gameName:"Garry's Mod"},{id:"rimworld_workshop_1",image:"https://images.steamusercontent.com/ugc/16432158161015345/336646E81559B37E9CC2834A8C5282EB01D18797/?imw=512&&ima=fit&impolicy=Letterbox&imcolor=%23000000&letterbox=false",title:"Scrollable Genelist",text:"<p><strong>From: RimWorld Workshop</strong></p><p>Adds a scrollable genelist.</p>",gameName:"RimWorld"},{id:"bf1_screenshot_1",image:"https://images.steamusercontent.com/ugc/43453755107685572/57E5249FB33DB6E426A205C55E52D6DC37594EAD/?imw=1024&&ima=fit&impolicy=Letterbox&imcolor=%23000000&letterbox=false",title:"Battlefield 1 Screenshot",text:"<p><strong>From: Battlefield 1 Hub</strong></p><p>Atmospheric shot by community.</p>",gameName:"Battlefield 1"},{id:"rdr2_screenshot_1",image:"https://shared.cloudflare.steamstatic.com/store_item_assets/steam/apps/1174180/ss_66b553f4c209476d3e4ce25fa4714002cc914c4f.jpg",title:"RDR2 Scenic View",text:"<p><strong>From: RDR2 Hub</strong></p><p>Beautiful landscape capture.</p>",gameName:"Red Dead Redemption 2"},{id:"tf2_summer_sale_fake",image:"https://cdn.cloudflare.steamstatic.com/steam/clusters/frontpage/71604dd1570ac66775f0f34b/page_bg_english.jpg?t=1688064039",title:"Summer Splash Sale!",text:`<p><strong>Deals!</strong></p><p>Summer Splash Sale near! Massive discounts, indie to AAA.</p><p>Starts Thurs! Wishlist?</p>`}];
        let libraryGameIds=[];let storeGameIds=Object.keys(allGameData);let cartGameIds=[];let currentGameId=null;let downloadInterval=null;let downloadProgress=0;let gameDownloadState={};let reviewScrollInterval=null;let tooltipTimeout=null;let currentHlsInstance=null;
        const libraryGameList=document.getElementById('library-game-list');const librarySearchInput=document.getElementById('library-search');const gameDetailsView=document.getElementById('game-details-view');const libraryEmptyPlaceholder=document.getElementById('library-empty-placeholder');const storeGrid=document.getElementById('store-grid');const communityFeed=document.getElementById('community-feed');const infoTooltip=document.getElementById('info-tooltip');const navTabs=document.querySelectorAll('.nav-tab');const cartButton=document.getElementById('cart-button');const cartCount=document.getElementById('cart-count');const checkoutModal=document.getElementById('checkout-modal');const checkoutSummary=document.getElementById('checkout-summary');const checkoutItemList=document.getElementById('checkout-item-list');const confirmCheckoutButton=document.getElementById('confirm-checkout-button');const cancelCheckoutButton=document.getElementById('cancel-checkout-button');const resetLibraryButton=document.getElementById('reset-library-button');
        const achievementsModal = document.getElementById('achievements-modal');
        const achievementsModalList = document.getElementById('achievements-modal-list');
        const closeAchievementsModalButton = document.getElementById('close-achievements-modal');


        const getIcon=(type,options={width:24,height:24})=>{const{width,height}=options;const svgs={settings:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="${width}" height="${height}"><path fill="currentColor" d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.08-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"/></svg>`,play:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="${width}" height="${height}"><path fill="currentColor" d="M8 5v14l11-7z"/></svg>`,download:`<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='${width}' height='${height}'><path fill='currentColor' d='M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z'/></svg>`,playtime:`<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='${width}' height='${height}'><path fill='currentColor' d='M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z'/></svg>`,steamdeck:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="${width}" height="${height}"><path fill="currentColor" d="M7.777 4.302a5.698 5.698 0 1 1 0 11.396v3.19a8.889 8.889 0 1 0 0-17.777v3.191Zm0 9.587a3.889 3.889 0 1 0 0-7.778 3.889 3.889 0 0 0 0 7.778Z"></path></svg>`,verified:`<svg viewBox="0 0 20 20" width="${width}" height="${height}"><path fill-rule="evenodd" fill="currentColor" d="M10 19a9 9 0 1 0 0-18 9 9 0 0 0 0 18Zm-1.667-7.078 6.162-6.155 1.96 1.96-8.122 8.129-5.066-5.073 1.96-1.96 3.106 3.1Z"></path></svg>`,playable:`<svg viewBox="0 0 20 20" width="${width}" height="${height}"><path fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M10 19C14.9706 19 19 14.9706 19 10C19 5.02944 14.9706 1 10 1C5.02944 1 1 5.02944 1 10C1 14.9706 5.02944 19 10 19ZM8.61079 9.44444V15H11.3886V9.44444H8.61079ZM9.07372 8.05245C9.34781 8.23558 9.67004 8.33333 9.99967 8.33333C10.4417 8.33333 10.8656 8.15774 11.1782 7.84518C11.4907 7.53262 11.6663 7.10869 11.6663 6.66667C11.6663 6.33703 11.5686 6.0148 11.3855 5.74072C11.2023 5.46663 10.942 5.25301 10.6375 5.12687C10.3329 5.00072 9.99783 4.96771 9.67452 5.03202C9.35122 5.09633 9.05425 5.25507 8.82116 5.48815C8.58808 5.72124 8.42934 6.01821 8.36503 6.34152C8.30072 6.66482 8.33373 6.99993 8.45988 7.30447C8.58602 7.60902 8.79964 7.86931 9.07372 8.05245Z"></path></svg>`};const images={disk:'https://cdn-icons-png.freepik.com/512/77/77649.png',unlock:'https://cdn3.iconfinder.com/data/icons/glypho-generic-icons/64/lock-unlocked-512.png',trophy:'https://www.freeiconspng.com/uploads/leaderboard-trophy-icon-32.png',reviews:'https://cdn-icons-png.flaticon.com/512/25/25297.png'};if(svgs[type])return svgs[type];if(images[type])return`<img src="${images[type]}" alt="${type} icon" loading="lazy" width="${width}" height="${height}" style="object-fit:contain;">`;return '';};
        const generateVideoThumbnail=(v,f,t=1)=>{return new Promise(r=>{if(!v||!v.src){r(f);return;}const c=document.createElement('canvas');const x=c.getContext('2d');let h=null;const clean=()=>{v.onseeked=v.onloadeddata=v.onerror=null;clearTimeout(h);c.remove();};const rFall=s=>{console.warn(`Thumb gen failed(${s}),using fallback:`,f);clean();r(f);};const setThumb=()=>{if(!v.videoWidth||!v.videoHeight||v.readyState<v.HAVE_CURRENT_DATA){rFall("Video data not ready");return;}const w=100;c.width=w;c.height=(v.videoHeight/v.videoWidth)*w;try{x.drawImage(v,0,0,c.width,c.height);const d=c.toDataURL('image/jpeg',0.8);clean();r(d);}catch(e){rFall(`Canvas error(${e.name})`);}};v.onerror=()=>rFall("Video load error");h=setTimeout(()=>rFall("Timeout"),5000);const trySeek=()=>{try{if(Math.abs(v.currentTime-t)>0.1){v.onseeked=setThumb;v.currentTime=t;setTimeout(()=>{if(v.onseeked)setThumb();},300);}else{setThumb();}}catch(e){rFall(`Seek error`);}};if(v.readyState>=v.HAVE_METADATA){trySeek();}else{v.onloadeddata=()=>{if(v.onloadeddata)trySeek();};}});};
        function showTooltip(el,cont){clearTimeout(tooltipTimeout);infoTooltip.innerHTML=cont;infoTooltip.style.left='0px';infoTooltip.style.top='0px';infoTooltip.style.visibility='hidden';infoTooltip.style.display='block';const rect=el.getBoundingClientRect();const tipR=infoTooltip.getBoundingClientRect();let top=rect.bottom+10;let left=rect.left+(rect.width/2)-(tipR.width/2);if(top+tipR.height>window.innerHeight-10)top=rect.top-tipR.height-10;if(top<10)top=10;if(left+tipR.width>window.innerWidth-10)left=window.innerWidth-tipR.width-10;if(left<10)left=10;infoTooltip.style.left=`${left}px`;infoTooltip.style.top=`${top}px`;infoTooltip.style.visibility='visible';infoTooltip.classList.add('visible');}
        function hideTooltip(){clearTimeout(tooltipTimeout);tooltipTimeout=setTimeout(()=>{infoTooltip.classList.remove('visible');clearInterval(reviewScrollInterval);},100);}
        // --- Updated updateLibrarySidebar function ---
        function updateLibrarySidebar(term = '') {
            libraryGameList.innerHTML = '';

            // 1. Sort all library game IDs alphabetically by name
            const sortedLibraryIds = [...libraryGameIds].sort((a, b) => {
                const nameA = allGameData[a]?.name?.toLowerCase() || '';
                const nameB = allGameData[b]?.name?.toLowerCase() || '';
                if (nameA < nameB) return -1;
                if (nameA > nameB) return 1;
                return 0;
            });

            // 2. Filter the sorted list based on the search term
            const filteredIds = sortedLibraryIds.filter(id =>
                allGameData[id]?.name.toLowerCase().includes(term.toLowerCase())
            );

            libraryEmptyPlaceholder.style.display = (libraryGameIds.length === 0) ? 'flex' : 'none';
            if (gameDetailsView && libraryGameIds.length === 0) gameDetailsView.innerHTML = '';

            if (libraryGameIds.length > 0 && filteredIds.length === 0) {
                libraryGameList.innerHTML = `<li class="library-placeholder">No games found for "${term}".</li>`;
            } else {
                filteredIds.forEach(id => {
                    const game = allGameData[id];
                    if (!game) return;
                    const li = document.createElement('li');
                    li.className = 'library-game-item';
                    li.dataset.gameId = id;
                    li.innerHTML = `<img src="${game.icon}" alt="${game.name} icon" loading="lazy"><span>${game.name}</span>`;
                    li.addEventListener('click', () => selectGame(id));
                    if (id === currentGameId) li.classList.add('active');
                    libraryGameList.appendChild(li);
                });
            }

            // Adjust game selection logic based on filtered results
            if ((!currentGameId || !filteredIds.includes(currentGameId)) && filteredIds.length > 0) {
                 selectGame(filteredIds[0]); // Select the first game in the filtered list
            } else if (filteredIds.length === 0 && libraryGameIds.length > 0 && gameDetailsView) {
                // If search yields no results but library isn't empty, show appropriate message
                gameDetailsView.innerHTML = '<div class="no-selection-placeholder">No search results. Clear search.</div>';
                currentGameId = null; // Deselect current game if it's not in the search results
                // Clear active state in the (hidden) list if needed
                const activeItem = libraryGameList.querySelector('.library-game-item.active');
                if (activeItem) activeItem.classList.remove('active');
            } else if (libraryGameIds.length === 0) {
                 // If library is truly empty, ensure placeholder is shown
                libraryEmptyPlaceholder.style.display = 'flex';
                if (gameDetailsView) gameDetailsView.innerHTML = ''; // Clear details view
                 currentGameId = null;
            }
        }
        function selectGame(id){if(currentGameId===id&&document.getElementById(`game-details-content-${id}`))return;const game=allGameData[id];if(!game){console.error("Game data missing:",id);return;};libraryGameList.querySelector('.library-game-item.active')?.classList.remove('active');libraryGameList.querySelector(`.library-game-item[data-game-id="${id}"]`)?.classList.add('active');currentGameId=id;const existing=gameDetailsView.querySelector('[id^="game-details-content-"]');if(existing){existing.classList.add('fade-out');existing.classList.remove('fade-in'); setTimeout(()=>{existing.remove();},parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--animation-duration')||'0.35')*1000);}renderGameDetails(game);}
        async function renderGameDetails(game){
             const content=document.createElement('div');
             content.id=`game-details-content-${game.id}`;
             content.innerHTML=`<div class="game-banner"style="background-image:url('${game.banner}')"><div class="game-header"><h1 class="game-title">${game.name}</h1></div><div class="game-actions"id="game-actions-${game.id}"><div class="game-actions-buttons"><button class="action-button settings-button"id="settings-button-${game.id}"title="Settings"><span class="button-icon">${getIcon('settings',{width:24,height:24})}</span></button><button class="action-button play-button"id="play-button-${game.id}"data-game-id="${game.id}"><span class="button-icon"></span><span class="button-text"></span></button></div><div class="settings-dropdown"id="settings-dropdown-${game.id}"><div class="setting-item"><label>Fullscreen</label><label class="switch"><input type="checkbox"><span class="slider"></span></label></div><div class="setting-item"><label>Compat</label><label class="switch"><input type="checkbox"><span class="slider"></span></label></div></div><div class="download-progress-container"id="progress-container-${game.id}"><div class="progress-bar-bg"><div class="progress-bar-fg"id="progress-bar-${game.id}"></div></div><span class="download-speed"id="speed-counter-${game.id}">0MB/s</span></div></div></div><div class="game-content-area"><div class="game-left-column"><img class="game-cover"src="${game.cover}"alt="${game.name}"loading="lazy"><div class="game-info-panel"><h3>About</h3><p>${game.description}</p></div><div class="game-specs-panel"><h3>Tech</h3><span class="execution-label"><strong>Runs Via:</strong><span class="${game.executionType||'native'}">${(game.executionType||'native').charAt(0).toUpperCase()+(game.executionType||'native').slice(1)}</span></span><ul class="min-specs-list"><li><strong>Engine:</strong>${game.tech.engine}</li>${game.minSpecs}</ul><div class="tech-tags"id="tech-tags-${game.id}"></div></div></div><div class="game-right-column"><div class="media-viewer"id="media-viewer-${game.id}"><video id="game-trailer-${game.id}"playsinline muted loop controls controlsList="nodownload nofullscreen noremoteplayback"style="display:none;"crossorigin="anonymous"></video><img id="game-screenshot-${game.id}"src=""alt="Screenshot"style="display:none;"loading="lazy"><iframe id="game-iframe-${game.id}" style="display:none;" allowfullscreen></iframe></div><div class="media-thumbnails"id="media-thumbnails-${game.id}"></div><div class="game-meta-info"><div class="meta-item hoverable disk-usage-meta"><div class="meta-item-icon">${getIcon('disk')}</div><div class="meta-item-text"><strong>Disk</strong><span>${game.diskSizeGB||'?'} GB</span></div></div><div class="meta-item hoverable reviews-meta"><div class="meta-item-icon">${getIcon('reviews')}</div><div class="meta-item-text"><strong>Reviews</strong><span>${game.reviews?.percent||'N/A'}% Pos</span></div></div><div class="meta-item hoverable achievements-meta"><div class="meta-item-icon">${getIcon('trophy')}</div><div class="meta-item-text"><strong>Achieve</strong><span>${game.achievements?.length||0}</span></div></div><div class="meta-item hoverable playtime-meta"><div class="meta-item-icon">${getIcon('playtime')}</div><div class="meta-item-text"><strong>Playtime</strong><span>${game.playtime?.toFixed(1)||'N/A'}h</span></div></div><div class="meta-item${game.tech.verified===true?' verified':game.tech.verified===null?' playable':game.tech.verified===false?' unsupported':' unknown'} deck-verified-meta"><div class="meta-item-icon steamdeck-icon">${getIcon('steamdeck')}</div><div class="meta-item-text"><strong>Deck</strong><span id="deck-status-${game.id}"></span></div></div></div><div class="game-achievements-panel"><h3>Achieve</h3><div class="game-achievements-list"id="achievements-list-${game.id}"></div><!-- See More button will be added here by JS if needed --></div></div></div>`;
             gameDetailsView.appendChild(content);

             const videoEl = content.querySelector(`#game-trailer-${game.id}`);
             const iframeEl = content.querySelector(`#game-iframe-${game.id}`);
             const thumbsContainer = content.querySelector(`#media-thumbnails-${game.id}`);
             const fallbackImage = game.screenshots?.[0] ?? game.icon;

             if (game.trailer) {
                 const isYoutube = /youtu\.be|youtube\.com/.test(game.trailer);
                 const isHls = game.trailer.toLowerCase().includes('.m3u8');
                 const mediaType = isYoutube ? 'iframe' : (isHls ? 'video' : 'video');
                 if (mediaType === 'video' && videoEl) { if (!isHls) { videoEl.src = game.trailer; videoEl.load(); } }
                 const thumb = document.createElement('img'); thumb.className = 'media-thumbnail'; thumb.dataset.type = mediaType; thumb.dataset.src = game.trailer; thumb.alt = 'Trailer'; thumb.src = fallbackImage; thumb.loading = 'lazy'; thumb.addEventListener('click', () => switchMedia(mediaType, game.trailer, thumb, game.id)); thumbsContainer.appendChild(thumb);
                 if (mediaType === 'video' && videoEl && !isHls) { generateVideoThumbnail(videoEl, fallbackImage).then(generatedUrl => { if (generatedUrl && generatedUrl !== fallbackImage) { thumb.src = generatedUrl; } }).catch(err => { console.warn("Thumbnail gen fail", game.id, err); }); }
             }
             game.screenshots?.forEach((ss, i) => { const thumb = document.createElement('img'); thumb.className = 'media-thumbnail'; thumb.src = ss; thumb.alt = `Screenshot ${i + 1}`; thumb.dataset.type = 'image'; thumb.dataset.src = ss; thumb.loading = 'lazy'; thumb.addEventListener('click', () => switchMedia('image', ss, thumb, game.id)); thumbsContainer.appendChild(thumb); });
             const firstThumb = thumbsContainer.querySelector('.media-thumbnail');
             if (firstThumb) { switchMedia(firstThumb.dataset.type, firstThumb.dataset.src, firstThumb, game.id); } else { console.warn("No media for", game.id); content.querySelector('.media-viewer').innerHTML = '<div class="no-selection-placeholder" style="font-size: 1em; background: #000; color: var(--text-secondary);">No media available</div>'; }

             const deckMeta = content.querySelector('.deck-verified-meta');
             const deckSpan = content.querySelector(`#deck-status-${game.id}`);
             if (deckMeta && deckSpan) {
                deckMeta.classList.remove('verified', 'playable', 'unsupported', 'unknown'); // Reset classes
                if (game.tech.verified === true) { deckSpan.innerHTML = `${getIcon('verified', { width: 16, height: 16 })} Verified`; deckMeta.classList.add('verified'); }
                else if (game.tech.verified === null) { deckSpan.innerHTML = `${getIcon('playable', { width: 16, height: 16 })} Playable`; deckMeta.classList.add('playable'); }
                else if (game.tech.verified === false) { deckSpan.innerHTML = `Unsupported`; deckMeta.classList.add('unsupported'); }
                else { deckSpan.innerHTML = `Unknown`; deckMeta.classList.add('unknown'); }
             }

             addMetaTooltips(content, game);
             populateAchievements(content.querySelector(`#achievements-list-${game.id}`), game.achievements || [], game.id, game.name);
             populateTechTags(content.querySelector(`#tech-tags-${game.id}`), game.tech, game.executionType);
             setupSettingsButton(content.querySelector(`#settings-button-${game.id}`), content.querySelector(`#settings-dropdown-${game.id}`));
             updatePlayButtonState(game.id);
             setupPlayButtonAction(game.id, game);
             requestAnimationFrame(() => { requestAnimationFrame(() => { content.classList.add('fade-in'); }); });
          }

        function switchMedia(type,src,thumb,id){const c=document.getElementById(`game-details-content-${id}`);if(!c)return;const v=c.querySelector(`#game-trailer-${id}`);const i=c.querySelector(`#game-screenshot-${id}`);const f=c.querySelector(`#game-iframe-${id}`);const ts=c.querySelector(`#media-thumbnails-${id}`);if(!v||!i||!f||!ts)return;if(currentHlsInstance){currentHlsInstance.destroy();currentHlsInstance=null;}ts.querySelectorAll('.active').forEach(t=>t.classList.remove('active'));v.classList.remove('active');v.style.display='none';v.pause();v.removeAttribute('src');i.classList.remove('active');i.style.display='none';i.src='';f.classList.remove('active');f.style.display='none';f.src='';thumb.classList.add('active');if(type==='image'){i.style.display='block';i.src=src;i.classList.add('active');}else if(type==='iframe'){f.style.display='block';f.src=src;f.classList.add('active');}else if(type==='video'){v.style.display='block';const isHls=src.toLowerCase().includes('.m3u8');if(isHls&&typeof Hls !== 'undefined'&&Hls.isSupported()){currentHlsInstance=new Hls({debug:false});currentHlsInstance.loadSource(src);currentHlsInstance.attachMedia(v);v.classList.add('active');currentHlsInstance.on(Hls.Events.MANIFEST_PARSED,()=>{v.play().catch(()=>{});});currentHlsInstance.on(Hls.Events.ERROR,(e,d)=>{console.error("HLS Error:",d);});}else if(v.canPlayType('application/vnd.apple.mpegurl')||isHls){v.src=src;v.classList.add('active');v.play().catch(()=>{});}else{v.src=src;v.classList.add('active');v.play().catch(()=>{});}}else{console.warn("Unknown media type:",type);}}
        function addMetaTooltips(cont,game){const add=(sel,fn)=>{const el=cont.querySelector(sel);if(el){el.addEventListener('mouseenter',()=>showTooltip(el,fn(game)));el.addEventListener('mouseleave',hideTooltip);}};add('.disk-usage-meta',g=>{const gp=(g.diskSizeGB/g.totalDiskGB)*100||0;const op=Math.min(30+gp,100-gp);const fp=Math.max(0,100-gp-op);const r=35;const sw=10;const circ=2*Math.PI*r;const dash=p=>`${circ*(p/100||0)} ${circ*(1-(p/100||0))}`;const off=p=>-circ*(p/100||0);return`<div class="pie-chart-container"><div class="pie-chart"><svg class="pie-chart-svg"viewBox="0 0 ${2*(r+sw)} ${2*(r+sw)}"><circle class="pie-chart-bg"cx="${r+sw}"cy="${r+sw}"r="${r}"stroke-width="${sw}"></circle><circle class="pie-chart-game"cx="${r+sw}"cy="${r+sw}"r="${r}"stroke-dasharray="${dash(gp)}"stroke-dashoffset="0"stroke-width="${sw}"></circle><circle class="pie-chart-other"cx="${r+sw}"cy="${r+sw}"r="${r}"stroke-dasharray="${dash(op)}"stroke-dashoffset="${off(gp)}"stroke-width="${sw}"></circle></svg></div><div class="pie-legend"><div class="legend-item"><div class="legend-color-box"style="background:var(--accent-blue)"></div><div class="legend-text"><strong>${g.name.split(':')[0]}:</strong>${g.diskSizeGB?.toFixed(1)||'?'}GB(${gp.toFixed(1)}%)</div></div><div class="legend-item"><div class="legend-color-box"style="background:var(--text-secondary)"></div><div class="legend-text"><strong>Other:</strong>${((op/100)*(g.totalDiskGB||1024)).toFixed(1)}GB(${op.toFixed(1)}%)</div></div><div class="legend-item"><div class="legend-color-box"style="background:rgba(255,255,255,0.1)"></div><div class="legend-text"><strong>Free:</strong>${((fp/100)*(g.totalDiskGB||1024)).toFixed(1)}GB(${fp.toFixed(1)}%)</div></div><div class="disk-total">Total:${g.totalDiskGB||1024}GB</div></div></div>`;});
        const revEl=cont.querySelector('.reviews-meta');if(revEl&&game.reviews?.feed){revEl.addEventListener('mouseenter',()=>{const fd=game.reviews.feed.map(r=>`<div class="review-item">${r}</div>`).join('');const cnt=`<div style="margin-bottom:10px"><strong>${game.reviews.percent||'N/A'}% Positive</strong>(${(game.reviews.count||0).toLocaleString()} reviews)</div><div class="review-feed"id="review-feed-tooltip"><div class="review-feed-content">${fd}${fd}</div></div>`;showTooltip(revEl,cnt);const tc=document.getElementById('info-tooltip');if(tc.classList.contains('visible')){const fcn=tc.querySelector('.review-feed-content');const f=tc.querySelector('.review-feed');if(f&&fcn){let s=0;clearInterval(reviewScrollInterval);f.scrollTop=0;reviewScrollInterval=setInterval(()=>{s+=0.5;if(f.parentElement!==tc){clearInterval(reviewScrollInterval);return;}if(s>=fcn.scrollHeight/2){s=0;f.scrollTop=0;}else{f.scrollTop=s;}},30);}}else{clearInterval(reviewScrollInterval);}});revEl.addEventListener('mouseleave',hideTooltip);}
        add('.achievements-meta',g=>`<div class="achieve-tooltip-content">${g.achievements?.length||0 > 0 ? `Showing first ${Math.min(6,g.achievements?.length||0)} of ${g.achievements?.length||0} achievements.` : 'No Steam achievements for this game.'}</div>`);
        add('.playtime-meta',g=>{const p=g.playtime;const h=g.hltb;const max=h?.completionist;const pr=max?Math.min((p/max)*100,100):0;const st=max?h.story/max*100:0;const ex=max?h.extras/max*100:0;const v=n=>typeof n==='number'&&isFinite(n);if(!v(max)||max<=0)return`<div class="hltb-tooltip-content">Playtime:${(p||0).toFixed(1)}h(HLTB N/A)</div>`;return`<div class="hltb-tooltip-content"><div><strong>Playtime:</strong>${(p||0).toFixed(1)}hrs</div><div class="hltb-bar-container"><div class="hltb-progress-bar"style="width:${pr}%"></div>${v(st)?`<div class="hltb-marker"style="left:${st}%"><span class="hltb-label">Story(${h.story}h)</span></div>`:''}${v(ex)&&ex<100&&v(h.extras)?`<div class="hltb-marker"style="left:${ex}%"><span class="hltb-label">Extras(${h.extras}h)</span></div>`:''}<div class="hltb-marker"style="left:100%"><span class="hltb-label">100%(${h.completionist}h)</span></div></div></div>`;});
        const achList=cont.querySelector('.game-achievements-list');if(achList)achList.querySelectorAll('.achievement-item.hoverable').forEach(item=>{const d=item.dataset.desc;if(d && d !== 'N/A' && d !== 'Complete Story.' ){item.addEventListener('mouseenter',()=>showTooltip(item,`<div class="achieve-tooltip-content">${d}</div>`));item.addEventListener('mouseleave',hideTooltip);}});}

        function populateAchievements(listContainer, achs, gameId, gameName) {
            if (!listContainer) return;
            listContainer.innerHTML = '';
            const panel = listContainer.closest('.game-achievements-panel');
            const existingButton = panel?.querySelector('.see-more-achievements-button');
            if (existingButton) existingButton.remove();

            if (!achs || achs.length === 0) {
                listContainer.innerHTML = `<div style='color:var(--text-secondary);font-size:0.9em; padding: 10px 0;'>No Steam achievements found.</div>`;
                return;
            }
            const maxInitial = 6;
            const achievementsToShowInitially = achs.slice(0, maxInitial);
            achievementsToShowInitially.forEach(a => {
                const i = document.createElement('div');
                i.className = 'achievement-item hoverable';
                i.dataset.desc = a.desc || 'N/A';
                i.innerHTML = `<img class="achievement-icon" src="${a.img}" alt="${a.name}" loading="lazy"><span class="achievement-name">${a.name}</span><div class="achievement-unlock-icon">${getIcon('unlock', { width: 20, height: 20 })}</div>`;
                listContainer.appendChild(i);
            });
            if (achs.length > maxInitial) {
                const seeMoreBtn = document.createElement('button');
                seeMoreBtn.className = 'see-more-achievements-button';
                seeMoreBtn.textContent = `See All ${achs.length} Achievements`;
                seeMoreBtn.addEventListener('click', () => showAchievementsModal(achs, gameName));
                listContainer.insertAdjacentElement('afterend', seeMoreBtn);
            }
        }
        function showAchievementsModal(allAchievements, gameName) {
            if (!achievementsModal || !achievementsModalList) return;
            const modalTitle = achievementsModal.querySelector('h3');
            if (modalTitle) modalTitle.textContent = `${gameName} - All Achievements`;
            achievementsModalList.innerHTML = '';
            if (!allAchievements || allAchievements.length === 0) {
                 achievementsModalList.innerHTML = '<p style="color: var(--text-secondary); text-align: center;">No achievements found.</p>';
            } else {
                allAchievements.forEach(a => {
                    const item = document.createElement('div'); item.className = 'modal-achievement-item';
                    const sanitizedDesc = a.desc?.replace(/</g, "&lt;").replace(/>/g, "&gt;") || 'No description available.';
                    item.innerHTML = `<img class="modal-achievement-icon" src="${a.img}" alt="${a.name}" loading="lazy"><div class="modal-achievement-details"><div class="modal-achievement-name">${a.name.replace(/</g, "&lt;").replace(/>/g, "&gt;")}</div><div class="modal-achievement-desc">${sanitizedDesc}</div></div>`;
                    achievementsModalList.appendChild(item);
                });
            }
            achievementsModalList.scrollTop = 0;
            achievementsModal.classList.add('visible');
        }
        function hideAchievementsModal() { if (achievementsModal) { achievementsModal.classList.remove('visible'); } }
        function populateTechTags(cont,tech,executionType){if(!cont||!tech)return;cont.innerHTML='';const create=(txt,cls,ico='')=>{const t=document.createElement('span');t.className=`tech-tag ${cls}`;t.innerHTML=`${ico}${txt}`.trim();cont.appendChild(t);};if(tech.verified===true)create('Deck Verified','verified',getIcon('verified',{width:14,height:14}));else if(tech.verified===null)create('Deck Playable','supported',getIcon('playable',{width:14,height:14})); else if(tech.verified===false)create('Deck Unsupported','unsupported');tech.features?.forEach(f=>create(f.toUpperCase(),'supported'));tech.unsupported?.forEach(f=>create(f.toUpperCase(),'unsupported'));}
        function setupSettingsButton(btn,drop){if(!btn||!drop)return;btn.addEventListener('click',e=>{e.stopPropagation();const v=drop.classList.contains('visible');document.querySelectorAll('.settings-dropdown.visible').forEach(d=>d.classList.remove('visible'));if(!v)drop.classList.add('visible');});}document.addEventListener('click',e=>{const open=document.querySelector('.settings-dropdown.visible');if(open&&!open.contains(e.target)&&!e.target.closest('.settings-button'))open.classList.remove('visible');});
        function updatePlayButtonState(id){const cont=document.getElementById(`game-details-content-${id}`);if(!cont)return;const btn=cont.querySelector(`#play-button-${id}`);const prog=cont.querySelector(`#progress-container-${id}`);if(!btn||!prog)return;const iconC=btn.querySelector('.button-icon');const textC=btn.querySelector('.button-text');const state=gameDownloadState[id]||'not_downloaded';prog.classList.remove('visible');btn.disabled=false;btn.dataset.state=state;iconC.innerHTML='';textC.innerHTML='';switch(state){case'downloaded':iconC.innerHTML=getIcon('play');textC.textContent='Play';break;case'downloading':iconC.innerHTML=getIcon('download');textC.textContent='Downloading';btn.disabled=true;prog.classList.add('visible');break;default:iconC.innerHTML=getIcon('download');textC.textContent='Download';break;}}
        function setupPlayButtonAction(id,game){const cont=document.getElementById(`game-details-content-${id}`);if(!cont)return;const btn=cont.querySelector(`#play-button-${id}`);if(!btn)return;btn.addEventListener('click',()=>{const cur=document.getElementById(`game-details-content-${id}`);if(!cur)return;const bar=cur.querySelector(`#progress-bar-${id}`);const speed=cur.querySelector(`#speed-counter-${id}`);const state=gameDownloadState[id]||'not_downloaded';if(state==='not_downloaded'){gameDownloadState[id]='downloading';updatePlayButtonState(id);downloadProgress=0;if(bar)bar.style.width='0%';if(speed)speed.textContent='0.0MB/s';clearInterval(downloadInterval);downloadInterval=setInterval(()=>{const ctx=document.getElementById(`game-details-content-${id}`);const bctx=ctx?.querySelector(`#progress-bar-${id}`);const sctx=ctx?.querySelector(`#speed-counter-${id}`);if(!ctx||!bctx||!sctx||gameDownloadState[id]!=='downloading'){clearInterval(downloadInterval);return;}const s=Math.max(5,Math.random()*(game.diskSizeGB>5?50:25)+5);sctx.textContent=`${s.toFixed(1)}MB/s`;const inc=(s*0.1)/((game.diskSizeGB||1)*1024)*100;downloadProgress+=inc;downloadProgress=Math.min(downloadProgress,100);bctx.style.width=`${downloadProgress}%`;if(downloadProgress>=100){clearInterval(downloadInterval);gameDownloadState[id]='downloaded';updatePlayButtonState(id);}},100);}else if(state==='downloaded'){alert(`Launching ${game.name}...(Simulated${game.executionType==='emulation'?' via Emulator':' natively'})`);}});}
        function updateStore(){storeGrid.innerHTML='';const avail=storeGameIds.filter(id=>!libraryGameIds.includes(id));if(storeGameIds.length===0){storeGrid.innerHTML='<p class="no-selection-placeholder"style="grid-column:1/-1">Store empty.</p>';return;}if(avail.length===0){storeGrid.innerHTML='<p class="no-selection-placeholder"style="grid-column:1/-1">No more games available.</p>';return;}avail.forEach(id=>{const g=allGameData[id];const i=document.createElement('div');i.className='store-item';const carted=cartGameIds.includes(id);i.innerHTML=`<img class="store-item-image"src="${g.cover}"alt="${g.name}"loading="lazy"><div class="store-item-info"><div class="store-item-title">${g.name}</div><div class="store-item-price">${g.price}</div><button class="add-to-cart-button"data-game-id="${id}"${carted?'disabled':''}>${carted?'In Cart':'Add to Cart'}</button></div>`;const b=i.querySelector('button');if(carted)b.classList.add('in-cart');b.addEventListener('click',handleAddToCartClick);storeGrid.appendChild(i);});libraryGameIds.forEach(id=>{const b=storeGrid.querySelector(`.store-item button[data-game-id="${id}"]`);if(b){b.textContent='Owned';b.className='add-to-cart-button owned';b.disabled=true;}});}
        function handleAddToCartClick(e){const b=e.target.closest('button');if(!b)return;const id=b.dataset.gameId;if(b.disabled||cartGameIds.includes(id)||libraryGameIds.includes(id))return;cartGameIds.push(id);b.textContent='In Cart';b.classList.add('in-cart');b.disabled=true;updateCartButton();}
        function updateCartButton(){cartCount.textContent=cartGameIds.length;cartCount.style.display=cartGameIds.length>0?'flex':'none';cartButton.style.filter=cartGameIds.length>0?'brightness(1.1)':'none';}
        function showCheckoutModal(){if(cartGameIds.length===0){alert("Cart empty!");return;}checkoutItemList.innerHTML='';let total=0;cartGameIds.forEach(id=>{const g=allGameData[id];checkoutItemList.innerHTML+=`<div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--glass-border);"><div style="display:flex;align-items:center;gap:10px;"><img src="${g.icon}"style="width:32px;height:32px;border-radius:4px"alt=""loading="lazy"><span style="color:var(--text-primary);font-size:0.95em">${g.name}</span></div><span style="color:var(--accent-green);font-weight:700;font-size:0.95em">${g.price}</span></div>`;const p=parseFloat(g.price.replace(/[^0-9.]/g,''));if(!isNaN(p))total+=p;});const last=checkoutItemList.querySelector(':scope>div:last-child');if(last)last.style.borderBottom='none';checkoutItemList.innerHTML+=`<div style="text-align:right;padding-top:15px;margin-top:10px;border-top:1px solid var(--glass-border);font-weight:bold;color:var(--text-primary);font-size:1.1em">Total:$${total.toFixed(2)}</div>`;checkoutSummary.textContent=`Add ${cartGameIds.length}game(s)to library?`;checkoutModal.classList.add('visible');}
        function hideCheckoutModal(){checkoutModal.classList.remove('visible');}
        function confirmCheckout(){const added=[...cartGameIds];cartGameIds=[];added.forEach(id=>{if(!libraryGameIds.includes(id)){libraryGameIds.push(id);gameDownloadState[id]='not_downloaded';}});hideCheckoutModal();updateLibrarySidebar();updateStore();updateCartButton();if(added.length>0){switchTab('library');selectGame(added[0]);const view=document.getElementById('game-details-view');if(view)view.scrollTop=0;}}
        function updateCommunityFeed(){communityFeed.innerHTML='';if(communityContent.length===0){communityFeed.innerHTML='<div class="no-selection-placeholder" style="grid-column:1/-1">No community content.</div>';return;}communityContent.forEach(p=>{const e=document.createElement('div');e.className='community-post';e.innerHTML=`<h3>${p.title}</h3><img src="${p.image}"alt="${p.title||'Community Post Image'}"loading="lazy">${p.text}`;communityFeed.appendChild(e);});}
        function switchTab(id){document.querySelectorAll('.content-area').forEach(a=>a.classList.remove('active'));navTabs.forEach(t=>t.classList.remove('active'));const btn=document.querySelector(`.nav-tab[data-tab="${id}"]`);if(btn)btn.classList.add('active');const cont=document.getElementById(`${id}-tab`);if(cont){cont.classList.add('active');cont.scrollTop=0;}}
        function resetLibrary(){clearInterval(downloadInterval);if(confirm("Reset Library simulation?")){libraryGameIds=[];cartGameIds=[];storeGameIds=Object.keys(allGameData);gameDownloadState={};currentGameId=null;updateLibrarySidebar();updateStore();updateCartButton();gameDetailsView.innerHTML='';libraryEmptyPlaceholder.style.display='flex';saveState();}}
        function saveState(){try{localStorage.setItem('gameHarborState',JSON.stringify({library:libraryGameIds,downloads:gameDownloadState}));}catch(e){console.error("Failed to save state:",e);}}
        function loadState(){const s=localStorage.getItem('gameHarborState');if(s){try{const d=JSON.parse(s);libraryGameIds=Array.isArray(d.library)?d.library:[];gameDownloadState=typeof d.downloads==='object'&&d.downloads!==null?d.downloads:{};}catch(e){libraryGameIds=[];gameDownloadState={};console.error("Failed to parse state",e);}}else{libraryGameIds=[];gameDownloadState={};}storeGameIds=Object.keys(allGameData);}

        document.addEventListener('DOMContentLoaded',()=>{
            loadState();
            updateLibrarySidebar(); // Initial load will now be sorted
            updateStore();
            updateCommunityFeed();
            updateCartButton();
            navTabs.forEach(t=>t.addEventListener('click',()=>switchTab(t.dataset.tab)));
            librarySearchInput.addEventListener('input',e=>updateLibrarySidebar(e.target.value));
            cartButton.addEventListener('click',showCheckoutModal);
            cancelCheckoutButton.addEventListener('click',hideCheckoutModal);
            confirmCheckoutButton.addEventListener('click',confirmCheckout);
            resetLibraryButton.addEventListener('click',resetLibrary);
            checkoutModal.addEventListener('click',e=>{if(e.target===checkoutModal)hideCheckoutModal()});
            if (closeAchievementsModalButton) { closeAchievementsModalButton.addEventListener('click', hideAchievementsModal); }
            if (achievementsModal) { achievementsModal.addEventListener('click', (e) => { if (e.target === achievementsModal) { hideAchievementsModal(); } }); }
            window.addEventListener('keydown', (e) => { if (e.key === 'Escape' && achievementsModal?.classList.contains('visible')) { hideAchievementsModal(); } });
            window.addEventListener('beforeunload',saveState);
            // Select first game *after* initial sort
             if(libraryGameIds.length>0&&!currentGameId){
                const sortedLibraryIds = [...libraryGameIds].sort((a, b) => {
                    const nameA = allGameData[a]?.name?.toLowerCase() || '';
                    const nameB = allGameData[b]?.name?.toLowerCase() || '';
                    if (nameA < nameB) return -1; if (nameA > nameB) return 1; return 0;
                });
                selectGame(sortedLibraryIds[0]);
             } else if (libraryGameIds.length === 0) {
                 libraryEmptyPlaceholder.style.display = 'flex';
             }

            console.log("Game Harbor Initialized");
        });
    </script>
</body>
</html>